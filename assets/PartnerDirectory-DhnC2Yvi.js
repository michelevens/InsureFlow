import{j as e}from"./vendor-query-D5ml2kdZ.js";import{r}from"./vendor-react-C8VcOkCS.js";import{ax as C,as as P,H as S,w as F,ai as k,ar as _,af as $,E as R,ad as h}from"./vendor-ui-tJ0aMxU9.js";import{b as c,B as d,C as w,I as y}from"./index-BZEM9EbM.js";import{B as g}from"./Badge-8fS5vckW.js";import{M as L}from"./Modal-Cn8_xSIn.js";function z(a){if(!a)return"";const l=Object.entries(a).filter(([,i])=>i!==void 0);return l.length?"?"+new URLSearchParams(l.map(([i,m])=>[i,String(m)])).toString():""}const N={list:a=>c.get(`/partners${z(a)}`),show:a=>c.get(`/partners/${a}`),create:a=>c.post("/partners",a),update:(a,l)=>c.put(`/partners/${a}`,l),destroy:a=>c.delete(`/partners/${a}`),refer:(a,l)=>c.post(`/partners/${a}/refer`,l),myReferrals:()=>c.get("/partners/my-referrals"),categories:()=>c.get("/partners/categories")};function W(){const[a,l]=r.useState([]),[i,m]=r.useState([]),[n,p]=r.useState("all"),[u,f]=r.useState(!0),[j,x]=r.useState(!1),[t,o]=r.useState(null);r.useEffect(()=>{(async()=>{f(!0);try{const[b,B]=await Promise.all([N.list(n!=="all"?{category:n}:void 0),N.categories()]);l(b.data),m(B)}catch{h.error("Failed to load partner directory")}finally{f(!1)}})()},[n]);const v=async s=>{try{await N.refer(s),h.success("Client referral sent successfully")}catch{h.error("Failed to send client referral")}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:"Partner Directory"}),e.jsx("p",{className:"text-slate-500 mt-1",children:"Find complementary service providers for your clients"})]}),e.jsxs(d,{variant:"shield",onClick:()=>x(!0),children:[e.jsx(C,{className:"w-4 h-4 mr-1"})," List Your Business"]})]}),e.jsxs("div",{className:"flex items-center gap-2 overflow-x-auto pb-1",children:[e.jsx(P,{className:"w-4 h-4 text-slate-400 flex-shrink-0"}),e.jsx("button",{onClick:()=>p("all"),className:`text-sm px-3 py-1.5 rounded-full whitespace-nowrap transition-colors ${n==="all"?"bg-shield-50 text-shield-700 font-medium":"text-slate-500 hover:bg-slate-100"}`,children:"All"}),i.map(s=>e.jsx("button",{onClick:()=>p(s),className:`text-sm px-3 py-1.5 rounded-full whitespace-nowrap transition-colors capitalize ${n===s?"bg-shield-50 text-shield-700 font-medium":"text-slate-500 hover:bg-slate-100"}`,children:s},s))]}),u?e.jsx(w,{className:"p-8 text-center",children:e.jsx("div",{className:"w-8 h-8 border-4 border-shield-200 border-t-shield-600 rounded-full animate-spin mx-auto"})}):a.length===0?e.jsxs(w,{className:"p-12 text-center",children:[e.jsx(S,{className:"w-12 h-12 text-slate-300 mx-auto mb-3"}),e.jsx("p",{className:"text-slate-500 mb-4",children:"No partners listed yet"}),e.jsxs(d,{variant:"shield",onClick:()=>x(!0),children:[e.jsx(C,{className:"w-4 h-4 mr-1"})," Be the First"]})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:a.map(s=>e.jsxs(w,{className:"p-5 hover:shadow-md transition-all",children:[e.jsxs("div",{className:"flex items-start gap-3 mb-3",children:[s.logo_url?e.jsx("img",{src:s.logo_url,alt:"",className:"w-12 h-12 rounded-xl object-cover"}):e.jsx("div",{className:"w-12 h-12 rounded-xl bg-shield-50 flex items-center justify-center",children:e.jsx(S,{className:"w-6 h-6 text-shield-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"font-bold text-slate-900",children:s.business_name}),s.is_verified&&e.jsx(g,{variant:"success",children:"Verified"})]}),e.jsx(g,{variant:"default",children:s.category})]})]}),s.description&&e.jsx("p",{className:"text-sm text-slate-500 line-clamp-2 mb-3",children:s.description}),e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(F,{className:"w-3.5 h-3.5 text-amber-400 fill-amber-400"}),e.jsx("span",{className:"text-sm font-medium text-slate-700",children:s.rating.toFixed(1)})]}),e.jsxs("span",{className:"text-xs text-slate-400",children:["(",s.review_count," reviews)"]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-500 mb-3",children:[s.website&&e.jsxs("a",{href:s.website,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1 text-shield-600 hover:underline",children:[e.jsx(k,{className:"w-3 h-3"})," Website"]}),s.phone&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(_,{className:"w-3 h-3"})," ",s.phone]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(d,{variant:"shield",size:"sm",className:"flex-1",onClick:()=>v(s.id),children:"Refer Client"}),e.jsx(d,{variant:"outline",size:"sm",onClick:()=>o(s),children:e.jsx($,{className:"w-3.5 h-3.5"})})]})]},s.id))}),t&&e.jsx(L,{isOpen:!0,onClose:()=>o(null),title:t.business_name,size:"md",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(g,{variant:"default",children:t.category}),t.is_verified&&e.jsx(g,{variant:"success",children:"Verified"})]}),t.description&&e.jsx("p",{className:"text-sm text-slate-700",children:t.description}),t.service_area&&t.service_area.length>0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-slate-500 uppercase mb-1",children:"Service Area"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:t.service_area.map(s=>e.jsx("span",{className:"text-xs bg-slate-100 text-slate-600 px-2 py-0.5 rounded-full",children:s},s))})]}),e.jsxs("div",{className:"space-y-2 text-sm text-slate-600",children:[t.website&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(k,{className:"w-4 h-4"})," ",e.jsx("a",{href:t.website,target:"_blank",rel:"noopener noreferrer",className:"text-shield-600 hover:underline",children:t.website})]}),t.phone&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_,{className:"w-4 h-4"})," ",t.phone]}),t.email&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(R,{className:"w-4 h-4"})," ",t.email]})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[e.jsx(d,{variant:"ghost",onClick:()=>o(null),children:"Close"}),e.jsx(d,{variant:"shield",onClick:()=>{v(t.id),o(null)},children:"Refer a Client"})]})]})}),j&&e.jsx(D,{onClose:()=>x(!1),onCreated:s=>{l(b=>[s,...b]),x(!1)}})]})}function D({onClose:a,onCreated:l}){const[i,m]=r.useState(""),[n,p]=r.useState(""),[u,f]=r.useState(""),[j,x]=r.useState(""),[t,o]=r.useState(!1),v=async()=>{if(!(!i||!n)){o(!0);try{const s=await N.create({business_name:i,category:n,description:u,website:j||null});h.success("Partner listing created successfully"),l(s)}catch{h.error("Failed to create partner listing")}finally{o(!1)}}};return e.jsx(L,{isOpen:!0,onClose:a,title:"List Your Business",size:"md",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(y,{label:"Business Name",placeholder:"Your Company LLC",value:i,onChange:s=>m(s.target.value)}),e.jsx(y,{label:"Category",placeholder:"Home Inspector, Financial Advisor, etc.",value:n,onChange:s=>p(s.target.value)}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 block mb-1",children:"Description"}),e.jsx("textarea",{value:u,onChange:s=>f(s.target.value),className:"w-full h-20 text-sm border border-slate-200 rounded-lg p-3 focus:ring-2 focus:ring-shield-500 focus:border-shield-500",placeholder:"Describe your services..."})]}),e.jsx(y,{label:"Website",placeholder:"https://...",value:j,onChange:s=>x(s.target.value)}),e.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[e.jsx(d,{variant:"ghost",onClick:a,children:"Cancel"}),e.jsx(d,{variant:"shield",onClick:v,disabled:t||!i||!n,children:t?"Listing...":"Create Listing"})]})]})})}export{W as default};
