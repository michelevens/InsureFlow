import{j as e}from"./vendor-query-D5ml2kdZ.js";import{r as i}from"./vendor-react-C8VcOkCS.js";import{p as d}from"./platformProducts-BULkPKof.js";import{R as y,ae as T,a9 as R,S as E,aI as F,aJ as $,ad as n}from"./vendor-ui-tJ0aMxU9.js";import"./index-CyWO3JYX.js";function J(){const[w,u]=i.useState([]),[o,g]=i.useState({}),[x,S]=i.useState(""),[c,C]=i.useState(""),[P,p]=i.useState(!0),[k,v]=i.useState(0),[f,j]=i.useState(!1),h=async()=>{try{p(!0);const s=await d.adminGetProducts({category:c||void 0,search:x||void 0});u(s.products),g(s.grouped),v(s.active_count??0)}catch{n.error("Failed to load products")}finally{p(!1)}};i.useEffect(()=>{h()},[c,x]);const A=async s=>{try{const a=await d.adminToggleProduct(s.id);u(l=>l.map(t=>t.id===s.id?a.product:t)),g(l=>{const t={...l};for(const r in t)t[r]=t[r].map(N=>N.id===s.id?a.product:N);return t}),v(l=>a.product.is_active?l+1:l-1)}catch{n.error("Failed to toggle product")}},_=async()=>{j(!0);try{await d.adminSyncProducts(),await h()}catch{n.error("Failed to sync products")}finally{j(!1)}},b=async(s,a)=>{const t=(o[s]||[]).map(r=>r.id);if(t.length!==0)try{await d.adminBulkToggle(t,a),await h()}catch{n.error("Failed to update products")}},m=Object.keys(o);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:"Platform Products"}),e.jsx("p",{className:"text-slate-500 mt-1",children:"Manage which insurance product types are available on the platform"})]}),e.jsxs("button",{onClick:_,disabled:f,className:"flex items-center gap-2 px-4 py-2 bg-shield-600 text-white rounded-lg hover:bg-shield-700 disabled:opacity-50",children:[e.jsx(y,{className:`w-4 h-4 ${f?"animate-spin":""}`}),"Sync from Registry"]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-4",children:[e.jsx("p",{className:"text-sm text-slate-500",children:"Total Products"}),e.jsx("p",{className:"text-2xl font-bold text-slate-900",children:w.length})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-4",children:[e.jsx("p",{className:"text-sm text-slate-500",children:"Active"}),e.jsx("p",{className:"text-2xl font-bold text-savings-600",children:k})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-4",children:[e.jsx("p",{className:"text-sm text-slate-500",children:"Categories"}),e.jsx("p",{className:"text-2xl font-bold text-shield-600",children:m.length})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(T,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400"}),e.jsx("input",{type:"text",placeholder:"Search products...",value:x,onChange:s=>S(s.target.value),className:"w-full pl-10 pr-4 py-2 border border-slate-200 rounded-lg focus:ring-2 focus:ring-shield-500 focus:border-shield-500"})]}),e.jsxs("select",{value:c,onChange:s=>C(s.target.value),className:"px-4 py-2 border border-slate-200 rounded-lg focus:ring-2 focus:ring-shield-500",children:[e.jsx("option",{value:"",children:"All Categories"}),m.map(s=>e.jsx("option",{value:s,children:s},s))]})]}),P?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx(y,{className:"w-8 h-8 animate-spin text-shield-500"})}):e.jsx("div",{className:"space-y-6",children:(c?[c]:m).map(s=>{const a=o[s]||[],l=a.filter(t=>t.is_active).length;return e.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4 bg-slate-50 border-b border-slate-200",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(R,{className:"w-5 h-5 text-shield-600"}),e.jsx("h2",{className:"font-semibold text-slate-900",children:s}),e.jsxs("span",{className:"text-sm text-slate-500",children:[l,"/",a.length," active"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>b(s,!0),className:"text-xs px-3 py-1 bg-savings-50 text-savings-700 rounded-full hover:bg-savings-100",children:"Enable All"}),e.jsx("button",{onClick:()=>b(s,!1),className:"text-xs px-3 py-1 bg-red-50 text-red-700 rounded-full hover:bg-red-100",children:"Disable All"})]})]}),e.jsx("div",{className:"divide-y divide-slate-100",children:a.map(t=>e.jsxs("div",{className:`flex items-center justify-between px-6 py-3 hover:bg-slate-50 transition-colors ${t.is_active?"":"opacity-50"}`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(E,{className:`w-5 h-5 ${t.is_active?"text-savings-500":"text-slate-300"}`}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-slate-900",children:t.name}),e.jsx("p",{className:"text-xs text-slate-400",children:t.slug})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full ${t.is_active?"bg-savings-50 text-savings-700":"bg-slate-100 text-slate-500"}`,children:t.is_active?"Active":"Inactive"}),e.jsx("button",{onClick:()=>A(t),className:"p-1 hover:bg-slate-100 rounded",children:t.is_active?e.jsx(F,{className:"w-6 h-6 text-savings-500"}):e.jsx($,{className:"w-6 h-6 text-slate-400"})})]})]},t.id))})]},s)})})]})}export{J as default};
