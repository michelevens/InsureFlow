import{j as e}from"./vendor-query-D5ml2kdZ.js";import{u as R,r as a}from"./vendor-react-C8VcOkCS.js";import{u as H,B as o,C as y,S as W,I as C}from"./index-BZEM9EbM.js";import{B as D}from"./Badge-8fS5vckW.js";import{M as I}from"./Modal-Cn8_xSIn.js";import{v as f}from"./videoMeetings-CiqYZFDU.js";import{V as A,aQ as Z,ax as J,ad as p,ai as L,a_ as E,an as O,a0 as z,af as q,b1 as k,bb as B,aY as G,b0 as Q,X}from"./vendor-ui-tJ0aMxU9.js";const T={scheduled:{label:"Scheduled",variant:"info"},waiting:{label:"Waiting",variant:"warning"},in_progress:{label:"In Progress",variant:"success"},completed:{label:"Completed",variant:"default"},cancelled:{label:"Cancelled",variant:"danger"}};function ce(){const s=R(),{user:u}=H(),[n,g]=a.useState([]),[j,d]=a.useState(!0),[l,x]=a.useState("meetings"),[m,r]=a.useState(!1),[h,i]=a.useState(null),[b,v]=a.useState(""),N=async()=>{d(!0);try{const t=await f.list(b?{status:b}:void 0);g(t)}catch{g([])}finally{d(!1)}};a.useEffect(()=>{N()},[b]);const w=async t=>{try{await f.start(t),p.success("Meeting started"),N()}catch{p.error("Failed to start meeting")}},c=async t=>{try{await f.end(t),p.success("Meeting ended"),N(),i(null)}catch{p.error("Failed to end meeting")}},U=async t=>{try{await f.cancel(t),p.success("Meeting cancelled"),N(),i(null)}catch{p.error("Failed to cancel meeting")}},_=async t=>{t.meeting_type==="external"&&t.external_url?window.open(t.external_url,"_blank"):s(`/meetings/${t.id}/room`)},S=async t=>{try{const V=await f.getLink(t.id);await navigator.clipboard.writeText(V.url),p.success("Meeting link copied")}catch{p.error("Failed to copy link")}},P=n.filter(t=>t.status==="scheduled"||t.status==="waiting"),F=n.filter(t=>t.status==="in_progress"),$=n.filter(t=>t.status==="completed"||t.status==="cancelled");return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:"Video Meetings"}),e.jsx("p",{className:"text-slate-500 mt-1",children:"Schedule and manage video consultations"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex bg-slate-100 rounded-lg p-1",children:[e.jsxs("button",{onClick:()=>x("meetings"),className:`px-3 py-1.5 text-sm rounded-md transition-colors ${l==="meetings"?"bg-white shadow text-slate-900 font-medium":"text-slate-500"}`,children:[e.jsx(A,{className:"w-4 h-4 inline mr-1"})," Meetings"]}),e.jsxs("button",{onClick:()=>x("settings"),className:`px-3 py-1.5 text-sm rounded-md transition-colors ${l==="settings"?"bg-white shadow text-slate-900 font-medium":"text-slate-500"}`,children:[e.jsx(Z,{className:"w-4 h-4 inline mr-1"})," Settings"]})]}),l==="meetings"&&e.jsxs(o,{variant:"shield",onClick:()=>r(!0),children:[e.jsx(J,{className:"w-4 h-4 mr-1"})," New Meeting"]})]})]}),l==="meetings"?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex gap-2",children:["","scheduled","in_progress","completed","cancelled"].map(t=>e.jsx("button",{onClick:()=>v(t),className:`px-3 py-1.5 text-sm rounded-lg transition-colors ${b===t?"bg-shield-600 text-white":"bg-slate-100 text-slate-600 hover:bg-slate-200"}`,children:t===""?"All":T[t]?.label||t},t))}),j?e.jsx(y,{className:"p-8 text-center",children:e.jsx("div",{className:"w-8 h-8 border-4 border-shield-200 border-t-shield-600 rounded-full animate-spin mx-auto"})}):n.length===0?e.jsxs(y,{className:"p-12 text-center",children:[e.jsx(A,{className:"w-12 h-12 text-slate-300 mx-auto mb-3"}),e.jsx("h3",{className:"text-lg font-medium text-slate-900 mb-1",children:"No meetings found"}),e.jsx("p",{className:"text-sm text-slate-500 mb-4",children:"Schedule a video meeting with a client or colleague"}),e.jsxs(o,{variant:"shield",onClick:()=>r(!0),children:[e.jsx(J,{className:"w-4 h-4 mr-1"})," Schedule Meeting"]})]}):e.jsxs("div",{className:"space-y-6",children:[F.length>0&&e.jsxs("div",{children:[e.jsx("h2",{className:"text-sm font-semibold text-slate-400 uppercase tracking-wider mb-3",children:"Active Now"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:F.map(t=>e.jsx(M,{meeting:t,userId:u?.id,onJoin:_,onEnd:c,onSelect:i,onCopy:S},t.id))})]}),P.length>0&&e.jsxs("div",{children:[e.jsx("h2",{className:"text-sm font-semibold text-slate-400 uppercase tracking-wider mb-3",children:"Upcoming"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:P.map(t=>e.jsx(M,{meeting:t,userId:u?.id,onJoin:_,onStart:w,onSelect:i,onCopy:S},t.id))})]}),$.length>0&&e.jsxs("div",{children:[e.jsx("h2",{className:"text-sm font-semibold text-slate-400 uppercase tracking-wider mb-3",children:"Past"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:$.map(t=>e.jsx(M,{meeting:t,userId:u?.id,onSelect:i,onCopy:S},t.id))})]})]})]}):e.jsx(K,{}),h&&e.jsx(Y,{meeting:h,userId:u?.id,onClose:()=>i(null),onJoin:_,onStart:w,onEnd:c,onCancel:U,onCopy:S}),m&&e.jsx(ee,{onClose:()=>r(!1),onCreated:()=>{N(),r(!1)}})]})}function M({meeting:s,userId:u,onJoin:n,onStart:g,onEnd:j,onSelect:d,onCopy:l}){const x=T[s.status],m=u===s.host_user_id,r=s.status==="in_progress",h=s.status==="scheduled"||s.status==="waiting";return e.jsxs(y,{className:`p-4 hover:shadow-md transition-shadow cursor-pointer ${r?"ring-2 ring-green-400":""}`,onClick:()=>d(s),children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[s.meeting_type==="external"?e.jsx(L,{className:"w-5 h-5 text-blue-500"}):e.jsx(E,{className:"w-5 h-5 text-shield-600"}),e.jsx("h3",{className:"font-medium text-slate-900 text-sm",children:s.title})]}),e.jsx(D,{variant:x.variant,children:x.label})]}),s.scheduled_at&&e.jsxs("div",{className:"flex items-center gap-1.5 text-xs text-slate-500 mb-2",children:[e.jsx(O,{className:"w-3.5 h-3.5"}),new Date(s.scheduled_at).toLocaleString(void 0,{dateStyle:"medium",timeStyle:"short"})]}),s.guest&&e.jsxs("div",{className:"flex items-center gap-1.5 text-xs text-slate-500 mb-3",children:[e.jsx(z,{className:"w-3.5 h-3.5"}),s.guest.name]}),s.external_service&&e.jsxs("div",{className:"flex items-center gap-1.5 text-xs text-slate-400 mb-3",children:[e.jsx(q,{className:"w-3 h-3"}),s.external_service]}),e.jsxs("div",{className:"flex items-center gap-2",onClick:i=>i.stopPropagation(),children:[r&&n&&e.jsxs(o,{variant:"shield",size:"sm",onClick:()=>n(s),children:[e.jsx(k,{className:"w-3.5 h-3.5 mr-1"})," Join"]}),h&&m&&g&&e.jsxs(o,{variant:"shield",size:"sm",onClick:()=>g(s.id),children:[e.jsx(k,{className:"w-3.5 h-3.5 mr-1"})," Start"]}),r&&m&&j&&e.jsxs(o,{variant:"danger",size:"sm",onClick:()=>j(s.id),children:[e.jsx(B,{className:"w-3.5 h-3.5 mr-1"})," End"]}),e.jsx(o,{variant:"ghost",size:"sm",onClick:()=>l(s),children:e.jsx(G,{className:"w-3.5 h-3.5"})})]})]})}function Y({meeting:s,userId:u,onClose:n,onJoin:g,onStart:j,onEnd:d,onCancel:l,onCopy:x}){const m=T[s.status],r=u===s.host_user_id,h=s.status==="in_progress",i=s.status==="scheduled"||s.status==="waiting";return e.jsx(I,{isOpen:!0,onClose:n,title:"Meeting Details",size:"md",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-slate-900",children:s.title}),e.jsx(D,{variant:m.variant,className:"mt-1",children:m.label})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400",children:"Type"}),e.jsx("p",{className:"font-medium capitalize",children:s.meeting_type})]}),s.scheduled_at&&e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400",children:"Scheduled"}),e.jsx("p",{className:"font-medium",children:new Date(s.scheduled_at).toLocaleString(void 0,{dateStyle:"medium",timeStyle:"short"})})]}),s.started_at&&e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400",children:"Started"}),e.jsx("p",{className:"font-medium",children:new Date(s.started_at).toLocaleString(void 0,{dateStyle:"medium",timeStyle:"short"})})]}),s.ended_at&&e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400",children:"Ended"}),e.jsx("p",{className:"font-medium",children:new Date(s.ended_at).toLocaleString(void 0,{dateStyle:"medium",timeStyle:"short"})})]}),s.external_service&&e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400",children:"Service"}),e.jsx("p",{className:"font-medium capitalize",children:s.external_service})]})]}),s.host&&e.jsxs("div",{className:"flex items-center gap-2 text-sm bg-slate-50 rounded-lg p-3",children:[e.jsx(z,{className:"w-4 h-4 text-slate-400"}),e.jsx("span",{children:s.host.name}),e.jsx("span",{className:"text-slate-400",children:"(Host)"})]}),s.guest&&e.jsxs("div",{className:"flex items-center gap-2 text-sm bg-slate-50 rounded-lg p-3",children:[e.jsx(z,{className:"w-4 h-4 text-slate-400"}),e.jsx("span",{children:s.guest.name}),e.jsx("span",{className:"text-slate-400",children:"(Guest)"})]}),s.external_url&&e.jsxs("a",{href:s.external_url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 text-sm text-shield-600 hover:underline",children:[e.jsx(Q,{className:"w-4 h-4"})," External meeting link"]}),e.jsxs("div",{className:"flex flex-wrap gap-2 pt-2 border-t border-slate-100",children:[h&&e.jsxs(o,{variant:"shield",size:"sm",onClick:()=>g(s),children:[e.jsx(k,{className:"w-3.5 h-3.5 mr-1"})," Join"]}),i&&r&&e.jsxs(o,{variant:"shield",size:"sm",onClick:()=>j(s.id),children:[e.jsx(k,{className:"w-3.5 h-3.5 mr-1"})," Start"]}),h&&r&&e.jsxs(o,{variant:"danger",size:"sm",onClick:()=>d(s.id),children:[e.jsx(B,{className:"w-3.5 h-3.5 mr-1"})," End"]}),i&&r&&e.jsxs(o,{variant:"danger",size:"sm",onClick:()=>l(s.id),children:[e.jsx(X,{className:"w-3.5 h-3.5 mr-1"})," Cancel"]}),e.jsxs(o,{variant:"ghost",size:"sm",onClick:()=>x(s),children:[e.jsx(G,{className:"w-3.5 h-3.5 mr-1"})," Copy Link"]})]})]})})}function K(){const[,s]=a.useState(null),[u,n]=a.useState(!0),[g,j]=a.useState(!1),[d,l]=a.useState("system"),[x,m]=a.useState(""),[r,h]=a.useState(""),[i,b]=a.useState(!0),[v,N]=a.useState(5);a.useEffect(()=>{(async()=>{n(!0);try{const c=await f.getSettings();s(c),l(c.preferred_provider),m(c.custom_service||""),h(c.custom_meeting_link||""),b(c.waiting_room_enabled),N(c.early_join_minutes)}catch{}finally{n(!1)}})()},[]);const w=async()=>{j(!0);try{const c=await f.updateSettings({preferred_provider:d,custom_service:d==="custom"?x:null,custom_meeting_link:d==="custom"?r:null,waiting_room_enabled:i,early_join_minutes:v});s(c),p.success("Settings saved")}catch{p.error("Failed to save settings")}finally{j(!1)}};return u?e.jsx(y,{className:"p-8 text-center",children:e.jsx("div",{className:"w-8 h-8 border-4 border-shield-200 border-t-shield-600 rounded-full animate-spin mx-auto"})}):e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(y,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-4",children:"Meeting Provider"}),e.jsx("p",{className:"text-sm text-slate-500 mb-4",children:"Choose between the built-in system video or use your own external meeting link (Zoom, Google Meet, Teams, etc.)"}),e.jsxs("div",{className:"space-y-3 mb-6",children:[e.jsxs("label",{className:"flex items-start gap-3 p-3 rounded-xl border border-slate-200 cursor-pointer hover:bg-slate-50 transition-colors",children:[e.jsx("input",{type:"radio",name:"provider",value:"system",checked:d==="system",onChange:()=>l("system"),className:"mt-0.5 rounded-full border-slate-300 text-shield-600 focus:ring-shield-500"}),e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium text-slate-900 flex items-center gap-2",children:[e.jsx(E,{className:"w-4 h-4 text-shield-600"})," System Video"]}),e.jsx("p",{className:"text-sm text-slate-500 mt-0.5",children:"Built-in video meeting â€” no external account needed"})]})]}),e.jsxs("label",{className:"flex items-start gap-3 p-3 rounded-xl border border-slate-200 cursor-pointer hover:bg-slate-50 transition-colors",children:[e.jsx("input",{type:"radio",name:"provider",value:"custom",checked:d==="custom",onChange:()=>l("custom"),className:"mt-0.5 rounded-full border-slate-300 text-shield-600 focus:ring-shield-500"}),e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium text-slate-900 flex items-center gap-2",children:[e.jsx(L,{className:"w-4 h-4 text-blue-500"})," Custom Provider"]}),e.jsx("p",{className:"text-sm text-slate-500 mt-0.5",children:"Use your own Zoom, Google Meet, Teams, or other meeting link"})]})]})]}),d==="custom"&&e.jsxs("div",{className:"space-y-3 mb-6 pl-4 border-l-2 border-shield-200",children:[e.jsx(W,{label:"Service",value:x,onChange:c=>m(c.target.value),options:[{value:"",label:"Select service..."},{value:"zoom",label:"Zoom"},{value:"google-meet",label:"Google Meet"},{value:"teams",label:"Microsoft Teams"},{value:"webex",label:"Webex"},{value:"other",label:"Other"}]}),e.jsx(C,{label:"Default Meeting Link",placeholder:"https://zoom.us/j/...",value:r,onChange:c=>h(c.target.value)})]}),e.jsx(o,{variant:"shield",onClick:w,disabled:g,children:g?"Saving...":"Save Settings"})]}),e.jsxs(y,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-4",children:"Meeting Preferences"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("label",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-slate-900 text-sm",children:"Waiting Room"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Guests wait until the host admits them"})]}),e.jsx("input",{type:"checkbox",checked:i,onChange:()=>b(!i),className:"rounded border-slate-300 text-shield-600 focus:ring-shield-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-900 mb-1",children:"Early Join (minutes)"}),e.jsx("p",{className:"text-xs text-slate-500 mb-2",children:"How early participants can join before the scheduled time"}),e.jsxs("select",{value:v,onChange:c=>N(Number(c.target.value)),className:"w-full border border-slate-200 rounded-lg px-3 py-2 text-sm",children:[e.jsx("option",{value:0,children:"No early join"}),e.jsx("option",{value:5,children:"5 minutes"}),e.jsx("option",{value:10,children:"10 minutes"}),e.jsx("option",{value:15,children:"15 minutes"}),e.jsx("option",{value:30,children:"30 minutes"})]})]})]})]})]})}function ee({onClose:s,onCreated:u}){const[n,g]=a.useState(""),[j,d]=a.useState(""),[l,x]=a.useState("system"),[m,r]=a.useState(""),[h,i]=a.useState(!1),b=async()=>{if(n){i(!0);try{await f.create({title:n,scheduled_at:j||void 0,meeting_type:l,external_url:l==="external"?m:void 0}),p.success("Meeting scheduled"),u()}catch{p.error("Failed to create meeting")}finally{i(!1)}}};return e.jsx(I,{isOpen:!0,onClose:s,title:"New Video Meeting",size:"md",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(C,{label:"Title",placeholder:"e.g. Policy review with John",value:n,onChange:v=>g(v.target.value)}),e.jsx(C,{label:"Scheduled Time",type:"datetime-local",value:j,onChange:v=>d(v.target.value)}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Meeting Type"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("button",{onClick:()=>x("system"),className:`p-3 rounded-xl border text-left transition-colors ${l==="system"?"border-shield-500 bg-shield-50":"border-slate-200 hover:bg-slate-50"}`,children:[e.jsx(E,{className:`w-5 h-5 mb-1 ${l==="system"?"text-shield-600":"text-slate-400"}`}),e.jsx("p",{className:"font-medium text-sm",children:"System Video"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Built-in meeting"})]}),e.jsxs("button",{onClick:()=>x("external"),className:`p-3 rounded-xl border text-left transition-colors ${l==="external"?"border-shield-500 bg-shield-50":"border-slate-200 hover:bg-slate-50"}`,children:[e.jsx(L,{className:`w-5 h-5 mb-1 ${l==="external"?"text-blue-500":"text-slate-400"}`}),e.jsx("p",{className:"font-medium text-sm",children:"External Link"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Zoom, Meet, Teams..."})]})]})]}),l==="external"&&e.jsx(C,{label:"Meeting URL",placeholder:"https://zoom.us/j/...",value:m,onChange:v=>r(v.target.value)}),e.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[e.jsx(o,{variant:"ghost",onClick:s,children:"Cancel"}),e.jsx(o,{variant:"shield",onClick:b,disabled:h||!n,children:h?"Creating...":"Create Meeting"})]})]})})}export{ce as default};
