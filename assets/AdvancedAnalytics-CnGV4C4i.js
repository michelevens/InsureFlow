import{j as e}from"./vendor-query-D5ml2kdZ.js";import{r as i}from"./vendor-react-C8VcOkCS.js";import{a as x}from"./analytics-Bna6lnj0.js";import{ad as y,L as w,t as j,D as h,T as _,z as C,u as S}from"./vendor-ui-tJ0aMxU9.js";import"./index-BZEM9EbM.js";function o({label:l,value:a,sub:s,icon:n,color:c}){return e.jsx("div",{className:"bg-white rounded-2xl border border-slate-200 p-5",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-slate-500",children:l}),e.jsx("p",{className:"text-2xl font-bold text-slate-900 mt-1",children:a}),s&&e.jsx("p",{className:"text-xs text-slate-400 mt-0.5",children:s})]}),e.jsx("div",{className:`w-10 h-10 rounded-xl ${c} flex items-center justify-center`,children:e.jsx(n,{className:"w-5 h-5"})})]})})}function A({funnel:l}){const a=Math.max(...l.map(s=>s.count),1);return e.jsx("div",{className:"space-y-3",children:l.map((s,n)=>e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-28 text-sm text-slate-600 text-right shrink-0",children:s.stage}),e.jsx("div",{className:"flex-1 h-8 bg-slate-100 rounded-lg overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-shield-500 to-confidence-500 rounded-lg flex items-center justify-end px-2 transition-all duration-500",style:{width:`${Math.max(s.count/a*100,8)}%`},children:e.jsx("span",{className:"text-xs font-bold text-white",children:s.count})})}),n>0&&l[n-1].count>0&&e.jsxs("span",{className:"text-xs text-slate-400 w-12 text-right",children:[Math.round(s.count/l[n-1].count*100),"%"]})]},s.stage))})}function L({trends:l}){const a=Math.max(...l.map(s=>Number(s.premium_volume)),1);return e.jsx("div",{className:"flex items-end gap-2 h-40",children:l.map(s=>e.jsxs("div",{className:"flex-1 flex flex-col items-center gap-1",children:[e.jsxs("span",{className:"text-xs text-slate-500 font-medium",children:["$",(Number(s.premium_volume)/1e3).toFixed(0),"k"]}),e.jsx("div",{className:"w-full bg-gradient-to-t from-green-500 to-green-400 rounded-t-lg transition-all duration-500",style:{height:`${Math.max(Number(s.premium_volume)/a*120,4)}px`}}),e.jsx("span",{className:"text-[10px] text-slate-400",children:s.month.slice(5)})]},s.month))})}function T(){const[l,a]=i.useState(null),[s,n]=i.useState(null),[c,p]=i.useState(null),[r,g]=i.useState(null),[N,u]=i.useState(!0),[d,b]=i.useState(6);return i.useEffect(()=>{u(!0),Promise.all([x.getConversionFunnel(d),x.getRevenueTrends(12),x.getAgentPerformance(d),x.getClaimsAnalytics(d)]).then(([t,m,f,v])=>{a(t),n(m),p(f),g(v)}).catch(()=>{y.error("Failed to load analytics")}).finally(()=>u(!1))},[d]),N?e.jsx("div",{className:"flex justify-center py-24",children:e.jsx(w,{className:"w-8 h-8 animate-spin text-slate-400"})}):e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:"Analytics"}),e.jsx("p",{className:"text-slate-500 mt-1",children:"Performance metrics and insights"})]}),e.jsxs("select",{value:d,onChange:t=>b(Number(t.target.value)),className:"rounded-xl border border-slate-200 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-shield-500",children:[e.jsx("option",{value:3,children:"Last 3 months"}),e.jsx("option",{value:6,children:"Last 6 months"}),e.jsx("option",{value:12,children:"Last 12 months"})]})]}),r&&e.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(o,{label:"Total Claims",value:r.total_claims,icon:j,color:"bg-amber-50 text-amber-600"}),e.jsx(o,{label:"Settled",value:r.settled_claims,icon:h,color:"bg-green-50 text-green-600"}),e.jsx(o,{label:"Avg Settlement",value:`$${r.avg_settlement.toLocaleString()}`,icon:h,color:"bg-blue-50 text-blue-600"}),e.jsx(o,{label:"Conversion Rate",value:l?`${l.conversion_rate}%`:"N/A",sub:"Lead → Policy",icon:_,color:"bg-purple-50 text-purple-600"})]}),e.jsxs("div",{className:"grid lg:grid-cols-2 gap-6",children:[l&&e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-5",children:[e.jsx(C,{className:"w-5 h-5 text-shield-600"}),e.jsx("h2",{className:"text-lg font-bold text-slate-900",children:"Conversion Funnel"})]}),e.jsx(A,{funnel:l.funnel})]}),s&&s.trends.length>0&&e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-5",children:[e.jsx(h,{className:"w-5 h-5 text-green-600"}),e.jsx("h2",{className:"text-lg font-bold text-slate-900",children:"Premium Volume"})]}),e.jsx(L,{trends:s.trends})]})]}),c&&c.agents.length>0&&e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-5",children:[e.jsx(S,{className:"w-5 h-5 text-confidence-600"}),e.jsx("h2",{className:"text-lg font-bold text-slate-900",children:"Agent Performance"})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-slate-500 border-b border-slate-100",children:[e.jsx("th",{className:"pb-3 font-medium",children:"#"}),e.jsx("th",{className:"pb-3 font-medium",children:"Agent"}),e.jsx("th",{className:"pb-3 font-medium text-right",children:"Leads"}),e.jsx("th",{className:"pb-3 font-medium text-right",children:"Policies"}),e.jsx("th",{className:"pb-3 font-medium text-right",children:"Commission"}),e.jsx("th",{className:"pb-3 font-medium text-right",children:"Conv. Rate"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-50",children:c.agents.map((t,m)=>e.jsxs("tr",{className:"hover:bg-slate-50",children:[e.jsx("td",{className:"py-3 text-slate-400",children:m+1}),e.jsxs("td",{className:"py-3",children:[e.jsx("p",{className:"font-medium text-slate-900",children:t.name}),e.jsx("p",{className:"text-xs text-slate-400",children:t.email})]}),e.jsx("td",{className:"py-3 text-right text-slate-700",children:t.lead_count}),e.jsx("td",{className:"py-3 text-right text-slate-700",children:t.policy_count}),e.jsxs("td",{className:"py-3 text-right font-medium text-green-700",children:["$",Number(t.total_commission||0).toLocaleString()]}),e.jsx("td",{className:"py-3 text-right text-slate-600",children:t.lead_count>0?`${Math.round(t.policy_count/t.lead_count*100)}%`:"—"})]},t.id))})]})})]}),r&&r.by_type.length>0&&e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-5",children:[e.jsx(j,{className:"w-5 h-5 text-amber-600"}),e.jsx("h2",{className:"text-lg font-bold text-slate-900",children:"Claims by Type"})]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:r.by_type.map(t=>e.jsxs("div",{className:"p-4 rounded-xl bg-slate-50 text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-slate-900",children:t.count}),e.jsx("p",{className:"text-xs text-slate-500 mt-1 capitalize",children:t.type.replace(/_/g," ")})]},t.type))})]})]})}export{T as default};
