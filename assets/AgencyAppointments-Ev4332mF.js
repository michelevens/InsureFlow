import{j as e}from"./vendor-query-D5ml2kdZ.js";import{r as i}from"./vendor-react-C8VcOkCS.js";import{p as o}from"./platformProducts-DTPgaKyM.js";import{b as m}from"./index-BZEM9EbM.js";import{ax as w,R as A,a$ as C,Q as k,d as S,X as P}from"./vendor-ui-tJ0aMxU9.js";const $={async list(){return m.get("/marketplace/carriers")},async get(l){return m.get(`/marketplace/carriers/${l}`)},async getProducts(l){return m.get(`/carrier/products?carrier_id=${l}`)},async updateProduct(l,c){return m.put(`/carrier/products/${l}`,c)}};function T(){const[l,c]=i.useState([]),[u,f]=i.useState([]),[b,g]=i.useState([]),[j,p]=i.useState(!0),[v,n]=i.useState(!1),[a,d]=i.useState({carrier_id:"",platform_product_id:"",appointment_number:"",effective_date:""}),x=async()=>{try{p(!0);const[t,s,r]=await Promise.all([o.getAppointments(),$.list(),o.getAgencyProducts()]);c(t),f(s.items||s),g(r.products.filter(y=>y.agency_enabled))}catch{}finally{p(!1)}};i.useEffect(()=>{x()},[]);const N=async()=>{if(!(!a.carrier_id||!a.platform_product_id))try{await o.createAppointment({carrier_id:parseInt(a.carrier_id),platform_product_id:parseInt(a.platform_product_id),appointment_number:a.appointment_number||void 0,effective_date:a.effective_date||void 0}),n(!1),d({carrier_id:"",platform_product_id:"",appointment_number:"",effective_date:""}),await x()}catch{}},_=async t=>{try{await o.deleteAppointment(t),c(s=>s.filter(r=>r.id!==t))}catch{}},h=l.reduce((t,s)=>{const r=s.carrier?.name||`Carrier #${s.carrier_id}`;return t[r]||(t[r]=[]),t[r].push(s),t},{});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:"Carrier Appointments"}),e.jsx("p",{className:"text-slate-500 mt-1",children:"Manage which carriers your agency is appointed with for each product"})]}),e.jsxs("button",{onClick:()=>n(!0),className:"flex items-center gap-2 px-4 py-2 bg-shield-600 text-white rounded-lg hover:bg-shield-700",children:[e.jsx(w,{className:"w-4 h-4"}),"Add Appointment"]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-4",children:[e.jsx("p",{className:"text-sm text-slate-500",children:"Total Appointments"}),e.jsx("p",{className:"text-2xl font-bold text-slate-900",children:l.length})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-4",children:[e.jsx("p",{className:"text-sm text-slate-500",children:"Carriers"}),e.jsx("p",{className:"text-2xl font-bold text-shield-600",children:Object.keys(h).length})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-4",children:[e.jsx("p",{className:"text-sm text-slate-500",children:"Active"}),e.jsx("p",{className:"text-2xl font-bold text-savings-600",children:l.filter(t=>t.is_active).length})]})]}),j?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx(A,{className:"w-8 h-8 animate-spin text-shield-500"})}):l.length===0?e.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-12 text-center",children:[e.jsx(C,{className:"w-12 h-12 text-slate-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:"No carrier appointments"}),e.jsx("p",{className:"text-slate-500 mt-1",children:"Add appointments to specify which carriers you can sell for each product type."})]}):e.jsx("div",{className:"space-y-4",children:Object.entries(h).map(([t,s])=>e.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 overflow-hidden",children:[e.jsxs("div",{className:"flex items-center gap-3 px-6 py-4 bg-slate-50 border-b border-slate-200",children:[e.jsx(k,{className:"w-5 h-5 text-shield-600"}),e.jsx("h2",{className:"font-semibold text-slate-900",children:t}),e.jsxs("span",{className:"text-sm text-slate-500",children:[s.length," product",s.length!==1?"s":""]})]}),e.jsx("div",{className:"divide-y divide-slate-100",children:s.map(r=>e.jsxs("div",{className:"flex items-center justify-between px-6 py-3 hover:bg-slate-50",children:[e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-slate-900",children:r.platform_product?.name||`Product #${r.platform_product_id}`}),e.jsxs("div",{className:"flex gap-3 text-xs text-slate-400 mt-0.5",children:[r.appointment_number&&e.jsxs("span",{children:["#",r.appointment_number]}),r.effective_date&&e.jsxs("span",{children:["Effective: ",r.effective_date]})]})]})}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full ${r.is_active?"bg-savings-50 text-savings-700":"bg-slate-100 text-slate-500"}`,children:r.is_active?"Active":"Inactive"}),e.jsx("button",{onClick:()=>_(r.id),className:"p-1 text-red-400 hover:text-red-600 hover:bg-red-50 rounded",children:e.jsx(S,{className:"w-4 h-4"})})]})]},r.id))})]},t))}),v&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-md p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-lg font-bold text-slate-900",children:"Add Carrier Appointment"}),e.jsx("button",{onClick:()=>n(!1),className:"p-1 hover:bg-slate-100 rounded",children:e.jsx(P,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Carrier"}),e.jsxs("select",{value:a.carrier_id,onChange:t=>d(s=>({...s,carrier_id:t.target.value})),className:"w-full px-3 py-2 border border-slate-200 rounded-lg focus:ring-2 focus:ring-shield-500",children:[e.jsx("option",{value:"",children:"Select carrier..."}),u.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Product"}),e.jsxs("select",{value:a.platform_product_id,onChange:t=>d(s=>({...s,platform_product_id:t.target.value})),className:"w-full px-3 py-2 border border-slate-200 rounded-lg focus:ring-2 focus:ring-shield-500",children:[e.jsx("option",{value:"",children:"Select product..."}),b.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Appointment Number (optional)"}),e.jsx("input",{type:"text",value:a.appointment_number,onChange:t=>d(s=>({...s,appointment_number:t.target.value})),placeholder:"e.g. APT-12345",className:"w-full px-3 py-2 border border-slate-200 rounded-lg focus:ring-2 focus:ring-shield-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Effective Date (optional)"}),e.jsx("input",{type:"date",value:a.effective_date,onChange:t=>d(s=>({...s,effective_date:t.target.value})),className:"w-full px-3 py-2 border border-slate-200 rounded-lg focus:ring-2 focus:ring-shield-500"})]})]}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsx("button",{onClick:()=>n(!1),className:"flex-1 px-4 py-2 border border-slate-200 text-slate-700 rounded-lg hover:bg-slate-50",children:"Cancel"}),e.jsx("button",{onClick:N,disabled:!a.carrier_id||!a.platform_product_id,className:"flex-1 px-4 py-2 bg-shield-600 text-white rounded-lg hover:bg-shield-700 disabled:opacity-50",children:"Add Appointment"})]})]})})]})}export{T as default};
