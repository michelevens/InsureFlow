import{j as e}from"./vendor-query-D5ml2kdZ.js";import{r as a}from"./vendor-react-C8VcOkCS.js";import{C as l,I as S,S as C,B as x}from"./index-BZEM9EbM.js";import{B as E}from"./Badge-8fS5vckW.js";import{p as y}from"./policies-sx9zuulL.js";import{S as j,a6 as _,m as k,D as L,ae as P,L as A,a5 as z,Y as B}from"./vendor-ui-tJ0aMxU9.js";const N={active:{label:"Active",variant:"success"},expiring_soon:{label:"Expiring Soon",variant:"warning"},expired:{label:"Expired",variant:"danger"},cancelled:{label:"Cancelled",variant:"default"}};function H(){const[r,f]=a.useState(""),[i,g]=a.useState(""),[d,v]=a.useState([]),[c,w]=a.useState({total:0,active:0,expiring_soon:0,expired:0}),[m,o]=a.useState(!0),[n,h]=a.useState("");a.useEffect(()=>{p()},[i]);const p=async()=>{try{o(!0),h("");const s=await y.list(i?{status:i}:void 0);v(s.items),w(s.counts)}catch(s){h(s instanceof Error?s.message:"Failed to load policies")}finally{o(!1)}},u=d.filter(s=>{if(!r)return!0;const t=r.toLowerCase();return(s.user?.name||"").toLowerCase().includes(t)||s.policy_number.toLowerCase().includes(t)||s.carrier_name.toLowerCase().includes(t)}),b=d.filter(s=>s.status==="active").reduce((s,t)=>s+(t.monthly_premium||0),0);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:"Policies"}),e.jsx("p",{className:"text-slate-500 mt-1",children:"Manage active and expiring insurance policies"})]}),e.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(l,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(j,{className:"w-8 h-8 text-savings-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xl font-bold text-slate-900",children:c.active}),e.jsx("p",{className:"text-sm text-slate-500",children:"Active"})]})]})}),e.jsx(l,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(_,{className:"w-8 h-8 text-amber-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xl font-bold text-slate-900",children:c.expiring_soon}),e.jsx("p",{className:"text-sm text-slate-500",children:"Expiring Soon"})]})]})}),e.jsx(l,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(k,{className:"w-8 h-8 text-slate-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xl font-bold text-slate-900",children:c.expired}),e.jsx("p",{className:"text-sm text-slate-500",children:"Expired"})]})]})}),e.jsx(l,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(L,{className:"w-8 h-8 text-shield-500"}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-xl font-bold text-slate-900",children:["$",b.toLocaleString(),"/mo"]}),e.jsx("p",{className:"text-sm text-slate-500",children:"Total Premium"})]})]})})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx(S,{placeholder:"Search by holder, policy number, or carrier...",value:r,onChange:s=>f(s.target.value),leftIcon:e.jsx(P,{className:"w-5 h-5"})})}),e.jsx("div",{className:"w-48",children:e.jsx(C,{options:[{value:"",label:"All Statuses"},{value:"active",label:"Active"},{value:"expiring_soon",label:"Expiring Soon"},{value:"expired",label:"Expired"}],value:i,onChange:s=>g(s.target.value)})})]}),n&&e.jsxs(l,{className:"p-6 text-center",children:[e.jsx("p",{className:"text-red-500",children:n}),e.jsx(x,{variant:"outline",size:"sm",className:"mt-2",onClick:p,children:"Retry"})]}),m&&e.jsxs(l,{className:"p-12 text-center",children:[e.jsx(A,{className:"w-8 h-8 animate-spin text-shield-500 mx-auto"}),e.jsx("p",{className:"text-slate-500 mt-2",children:"Loading policies..."})]}),!m&&!n&&e.jsx(l,{children:u.length===0?e.jsxs("div",{className:"p-12 text-center",children:[e.jsx(j,{className:"w-12 h-12 text-slate-300 mx-auto mb-3"}),e.jsx("p",{className:"text-slate-500",children:"No policies found"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-slate-100",children:[e.jsx("th",{className:"text-left text-xs font-medium text-slate-500 uppercase tracking-wider p-4",children:"Policy #"}),e.jsx("th",{className:"text-left text-xs font-medium text-slate-500 uppercase tracking-wider p-4",children:"Holder"}),e.jsx("th",{className:"text-left text-xs font-medium text-slate-500 uppercase tracking-wider p-4",children:"Type"}),e.jsx("th",{className:"text-left text-xs font-medium text-slate-500 uppercase tracking-wider p-4",children:"Carrier"}),e.jsx("th",{className:"text-left text-xs font-medium text-slate-500 uppercase tracking-wider p-4",children:"Premium"}),e.jsx("th",{className:"text-left text-xs font-medium text-slate-500 uppercase tracking-wider p-4",children:"Status"}),e.jsx("th",{className:"text-left text-xs font-medium text-slate-500 uppercase tracking-wider p-4",children:"Expiration"}),e.jsx("th",{className:"text-right text-xs font-medium text-slate-500 uppercase tracking-wider p-4",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-50",children:u.map(s=>{const t=N[s.status]||N.active;return e.jsxs("tr",{className:"hover:bg-slate-50",children:[e.jsx("td",{className:"p-4 font-mono text-sm text-shield-600",children:s.policy_number}),e.jsx("td",{className:"p-4 font-medium text-slate-900",children:s.user?.name||"-"}),e.jsx("td",{className:"p-4 text-sm text-slate-700 capitalize",children:(s.type||"").replace(/_/g," ")}),e.jsx("td",{className:"p-4 text-sm text-slate-700",children:s.carrier_name}),e.jsxs("td",{className:"p-4 text-sm font-medium text-slate-900",children:["$",s.monthly_premium,"/mo"]}),e.jsx("td",{className:"p-4",children:e.jsx(E,{variant:t.variant,children:t.label})}),e.jsx("td",{className:"p-4 text-sm text-slate-500",children:s.expiration_date}),e.jsx("td",{className:"p-4 text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-1",children:[e.jsx(x,{variant:"ghost",size:"sm",children:e.jsx(z,{className:"w-4 h-4"})}),e.jsx(x,{variant:"ghost",size:"sm",children:e.jsx(B,{className:"w-4 h-4"})})]})})]},s.id)})})]})})})]})}export{H as default};
