import{j as e}from"./vendor-query-D5ml2kdZ.js";import{r as i}from"./vendor-react-C8VcOkCS.js";import{C as c,B as n,I as u}from"./index-BZEM9EbM.js";import{B as j}from"./Badge-8fS5vckW.js";import{a as d}from"./admin-CrYMalje.js";import{ad as l,L as E,ax as F,D as M,aa as y,u as I,aO as T,d as z,X as B}from"./vendor-ui-tJ0aMxU9.js";const b={name:"",slug:"",role:"agent",price_monthly:0,price_yearly:0,is_active:!0,is_popular:!1,sort_order:0};function U(){const[o,_]=i.useState([]),[P,p]=i.useState(!0),[w,r]=i.useState(!1),[x,g]=i.useState(null),[a,t]=i.useState(b),[f,v]=i.useState(!1);i.useEffect(()=>{m()},[]);const m=async()=>{p(!0);try{const s=await d.getPlans();_(s)}catch{l.error("Failed to load plans")}finally{p(!1)}},C=o.filter(s=>s.is_active).length,N=s=>{s?(g(s),t({name:s.name,slug:s.slug,role:s.role,price_monthly:s.price_monthly,price_yearly:s.price_yearly,is_active:s.is_active,is_popular:s.is_popular,sort_order:s.sort_order})):(g(null),t(b)),r(!0)},k=async()=>{if(!a.name.trim()){l.error("Name is required");return}v(!0);try{x?(await d.updatePlan(x.id,a),l.success("Plan updated")):(await d.createPlan(a),l.success("Plan created")),r(!1),m()}catch{l.error("Failed to save plan")}finally{v(!1)}},S=async s=>{try{await d.updatePlan(s.id,{is_active:!s.is_active}),l.success(s.is_active?"Plan deactivated":"Plan activated"),m()}catch{l.error("Failed to update plan")}},A=async s=>{if(confirm(`Delete "${s.name}"? This cannot be undone.`))try{await d.deletePlan(s.id),l.success("Plan deleted"),m()}catch{l.error("Failed to delete plan")}};return P?e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{children:e.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:"Subscription Plans"})}),e.jsxs(c,{className:"p-12 text-center",children:[e.jsx(E,{className:"w-8 h-8 animate-spin text-shield-500 mx-auto"}),e.jsx("p",{className:"text-slate-500 mt-2",children:"Loading plans..."})]})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:"Subscription Plans"}),e.jsx("p",{className:"text-slate-500 mt-1",children:"Manage pricing and subscription tiers"})]}),e.jsx(n,{variant:"shield",leftIcon:e.jsx(F,{className:"w-4 h-4"}),onClick:()=>N(),children:"Create Plan"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsx(c,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(M,{className:"w-8 h-8 text-savings-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xl font-bold text-slate-900",children:o.length}),e.jsx("p",{className:"text-sm text-slate-500",children:"Total Plans"})]})]})}),e.jsx(c,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(y,{className:"w-8 h-8 text-confidence-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xl font-bold text-slate-900",children:C}),e.jsx("p",{className:"text-sm text-slate-500",children:"Active Plans"})]})]})}),e.jsx(c,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(I,{className:"w-8 h-8 text-shield-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xl font-bold text-slate-900",children:o.filter(s=>s.role==="agent"||s.role==="agency_owner").length}),e.jsx("p",{className:"text-sm text-slate-500",children:"Agent/Agency Plans"})]})]})})]}),e.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6",children:o.map(s=>e.jsxs(c,{className:"flex flex-col",children:[e.jsxs("div",{className:"p-6 flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx(j,{variant:"outline",className:"capitalize",children:s.role.replace("_"," ")}),e.jsx("button",{onClick:()=>S(s),children:e.jsx(j,{variant:s.is_active?"success":"default",className:"cursor-pointer",children:s.is_active?"Active":"Inactive"})})]}),e.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-1",children:s.name}),e.jsxs("div",{className:"flex items-baseline gap-1 mb-2",children:[e.jsxs("span",{className:"text-3xl font-bold text-slate-900",children:["$",s.price_monthly]}),e.jsx("span",{className:"text-slate-500",children:"/mo"})]}),s.price_yearly>0&&e.jsxs("p",{className:"text-sm text-slate-500 mb-4",children:["$",s.price_yearly,"/year",s.price_monthly>0&&` (save ${Math.round((1-s.price_yearly/(s.price_monthly*12))*100)}%)`]}),s.features&&typeof s.features=="object"&&e.jsx("div",{className:"space-y-2 mb-4",children:Object.entries(s.features).filter(([,h])=>h).slice(0,6).map(([h])=>e.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-600",children:[e.jsx(y,{className:"w-4 h-4 text-savings-500 flex-shrink-0"}),h.replace(/_/g," ")]},h))}),s.is_popular&&e.jsx(j,{variant:"shield",className:"mb-2",children:"Popular"})]}),e.jsxs("div",{className:"border-t border-slate-100 p-4 flex gap-2",children:[e.jsx(n,{variant:"outline",size:"sm",className:"flex-1",leftIcon:e.jsx(T,{className:"w-4 h-4"}),onClick:()=>N(s),children:"Edit"}),e.jsx(n,{variant:"ghost",size:"sm",onClick:()=>A(s),children:e.jsx(z,{className:"w-4 h-4 text-red-500"})})]})]},s.id))}),w&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",onClick:()=>r(!1),children:e.jsxs(c,{className:"w-full max-w-md p-6",onClick:s=>s.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:x?"Edit Plan":"Create Plan"}),e.jsx("button",{onClick:()=>r(!1),children:e.jsx(B,{className:"w-5 h-5 text-slate-400"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700",children:"Name"}),e.jsx(u,{value:a.name,onChange:s=>t({...a,name:s.target.value}),placeholder:"Agent Pro"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700",children:"Slug"}),e.jsx(u,{value:a.slug,onChange:s=>t({...a,slug:s.target.value}),placeholder:"agent-pro"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700",children:"Target Role"}),e.jsxs("select",{value:a.role,onChange:s=>t({...a,role:s.target.value}),className:"w-full px-3 py-2 border border-slate-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-shield-500",children:[e.jsx("option",{value:"agent",children:"Agent"}),e.jsx("option",{value:"agency_owner",children:"Agency Owner"}),e.jsx("option",{value:"carrier",children:"Carrier"}),e.jsx("option",{value:"consumer",children:"Consumer"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700",children:"Monthly Price"}),e.jsx(u,{type:"number",value:a.price_monthly,onChange:s=>t({...a,price_monthly:Number(s.target.value)})})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700",children:"Annual Price"}),e.jsx(u,{type:"number",value:a.price_yearly,onChange:s=>t({...a,price_yearly:Number(s.target.value)})})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("label",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"checkbox",checked:a.is_active,onChange:s=>t({...a,is_active:s.target.checked}),className:"w-4 h-4 rounded border-slate-300 text-shield-600 focus:ring-shield-500"}),e.jsx("span",{className:"text-sm text-slate-700",children:"Active"})]}),e.jsxs("label",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"checkbox",checked:a.is_popular,onChange:s=>t({...a,is_popular:s.target.checked}),className:"w-4 h-4 rounded border-slate-300 text-shield-600 focus:ring-shield-500"}),e.jsx("span",{className:"text-sm text-slate-700",children:"Popular"})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-2 mt-6",children:[e.jsx(n,{variant:"outline",onClick:()=>r(!1),children:"Cancel"}),e.jsx(n,{onClick:k,disabled:f,children:f?"Saving...":x?"Update":"Create"})]})]})})]})}export{U as default};
