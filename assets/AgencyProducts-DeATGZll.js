import{j as e}from"./vendor-query-D5ml2kdZ.js";import{r}from"./vendor-react-C8VcOkCS.js";import{p}from"./platformProducts-BULkPKof.js";import{aZ as k,R as A,a9 as C,ac as E}from"./vendor-ui-tJ0aMxU9.js";import"./index-CyWO3JYX.js";function G(){const[f,g]=r.useState([]),[i,b]=r.useState({}),[d,o]=r.useState(new Set),[j,h]=r.useState(!0),[m,u]=r.useState(!1),[y,x]=r.useState(!1),N=async()=>{try{h(!0);const s=await p.getAgencyProducts();g(s.products),b(s.grouped);const l=new Set(s.products.filter(t=>t.agency_enabled).map(t=>t.id));o(l)}catch{}finally{h(!1)}};r.useEffect(()=>{N()},[]);const v=s=>{o(l=>{const t=new Set(l);return t.has(s)?t.delete(s):t.add(s),t}),x(!0)},w=(s,l)=>{const t=i[s]||[];o(n=>{const a=new Set(n);return t.forEach(c=>{l?a.add(c.id):a.delete(c.id)}),a}),x(!0)},S=async()=>{u(!0);try{await p.updateAgencyProducts(Array.from(d)),x(!1)}catch{}finally{u(!1)}},P=Object.keys(i);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:"Agency Products"}),e.jsx("p",{className:"text-slate-500 mt-1",children:"Select which insurance products your agency supports"})]}),e.jsxs("button",{onClick:S,disabled:!y||m,className:"flex items-center gap-2 px-4 py-2 bg-shield-600 text-white rounded-lg hover:bg-shield-700 disabled:opacity-50",children:[e.jsx(k,{className:"w-4 h-4"}),m?"Saving...":"Save Changes"]})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 p-4",children:[e.jsxs("p",{className:"text-sm text-slate-500",children:[e.jsx("span",{className:"font-semibold text-shield-600",children:d.size})," of"," ",e.jsx("span",{className:"font-semibold",children:f.length})," products enabled"]}),d.size===0&&e.jsx("p",{className:"text-sm text-amber-600 mt-1",children:"Warning: No products selected â€” your calculator will not show any products to visitors."})]}),j?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx(A,{className:"w-8 h-8 animate-spin text-shield-500"})}):e.jsx("div",{className:"space-y-6",children:P.map(s=>{const l=i[s]||[],t=l.filter(a=>d.has(a.id)).length,n=t===l.length;return e.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4 bg-slate-50 border-b border-slate-200",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(C,{className:"w-5 h-5 text-shield-600"}),e.jsx("h2",{className:"font-semibold text-slate-900",children:s}),e.jsxs("span",{className:"text-sm text-slate-500",children:[t,"/",l.length," selected"]})]}),e.jsx("button",{onClick:()=>w(s,!n),className:"text-xs px-3 py-1 bg-shield-50 text-shield-700 rounded-full hover:bg-shield-100",children:n?"Deselect All":"Select All"})]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-0 divide-y sm:divide-y-0",children:l.map(a=>{const c=d.has(a.id);return e.jsxs("button",{onClick:()=>v(a.id),className:`flex items-center gap-3 px-6 py-3 text-left hover:bg-slate-50 transition-colors border-b sm:border-b-0 sm:border-r border-slate-100 ${c?"bg-shield-50/50":""}`,children:[e.jsx("div",{className:`w-5 h-5 rounded border-2 flex items-center justify-center flex-shrink-0 ${c?"bg-shield-600 border-shield-600":"border-slate-300"}`,children:c&&e.jsx(E,{className:"w-3 h-3 text-white"})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"font-medium text-slate-900 text-sm truncate",children:a.name}),e.jsx("p",{className:"text-xs text-slate-400 truncate",children:a.slug})]})]},a.id)})})]},s)})})]})}export{G as default};
