import{j as e}from"./vendor-query-D5ml2kdZ.js";import{r as t}from"./vendor-react-C8VcOkCS.js";import{B as h,C as u}from"./index-CyWO3JYX.js";import{B as w}from"./Badge-DV1ZXp4T.js";import{m as p}from"./marketplace-CWUGYLrO.js";import{ad as n,R as v,L as f,au as y,an as C,a8 as _,S as b,F as k,av as L}from"./vendor-ui-tJ0aMxU9.js";const R={auto:"Auto",homeowners:"Homeowners",renters:"Renters",life_term:"Term Life",life_whole:"Whole Life",life_universal:"Universal Life",health_individual:"Individual Health",medicare_supplement:"Medicare Supplement",disability_long_term:"Long-Term Disability",long_term_care:"Long-Term Care",commercial_gl:"Commercial GL",bop:"BOP",workers_comp:"Workers Comp",umbrella_personal:"Personal Umbrella",condo:"Condo",flood:"Flood"};function I(){const[c,o]=t.useState([]),[j,m]=t.useState(!0),[l,d]=t.useState(null),i=t.useCallback(async()=>{m(!0);try{const s=await p.listOpenRequests();o(s.data)}catch{n.error("Failed to load marketplace requests")}finally{m(!1)}},[]);t.useEffect(()=>{i()},[i]);const g=async s=>{d(s);try{const r=await p.unlockRequest(s);n.success("Request claimed! Lead created."),o(a=>a.filter(x=>x.id!==s)),window.location.href=`/crm/leads?highlight=${r.lead_id}`}catch{n.error("Failed to claim request")}finally{d(null)}},N=s=>{const r=Date.now()-new Date(s).getTime(),a=Math.floor(r/36e5);return a<1?"Just now":a<24?`${a}h ago`:`${Math.floor(a/24)}d ago`};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:"Insurance Marketplace"}),e.jsx("p",{className:"text-slate-500 mt-1",children:"Consumers looking for insurance in your area"})]}),e.jsx(h,{variant:"outline",size:"sm",onClick:i,leftIcon:e.jsx(v,{className:"w-4 h-4"}),children:"Refresh"})]}),j?e.jsx("div",{className:"flex items-center justify-center py-20",children:e.jsx(f,{className:"w-8 h-8 animate-spin text-shield-400"})}):c.length===0?e.jsxs(u,{className:"p-12 text-center",children:[e.jsx(y,{className:"w-12 h-12 text-slate-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-slate-900 mb-2",children:"No Open Requests"}),e.jsx("p",{className:"text-slate-500 max-w-md mx-auto",children:"There are no marketplace requests matching your licensed states right now. Check back later or refresh."})]}):e.jsx("div",{className:"grid md:grid-cols-2 gap-4",children:c.map(s=>e.jsxs(u,{className:"p-5 hover:shadow-lg transition-shadow",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{children:[e.jsx(w,{variant:"info",size:"sm",children:R[s.insurance_type]||s.insurance_type}),e.jsxs("h3",{className:"font-semibold text-slate-900 mt-2",children:[s.first_name," ",s.last_name?.charAt(0),"."]})]}),e.jsxs("div",{className:"flex items-center gap-1.5 text-xs text-slate-400",children:[e.jsx(C,{className:"w-3.5 h-3.5"}),N(s.created_at)]})]}),e.jsxs("div",{className:"space-y-1.5 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-600",children:[e.jsx(_,{className:"w-4 h-4 text-slate-400"}),s.state," â€” ",s.zip_code]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-600",children:[e.jsx(b,{className:"w-4 h-4 text-slate-400"}),s.coverage_level?.charAt(0).toUpperCase(),s.coverage_level?.slice(1)," coverage"]}),s.description&&e.jsxs("div",{className:"flex items-start gap-2 text-sm text-slate-600",children:[e.jsx(k,{className:"w-4 h-4 text-slate-400 mt-0.5"}),e.jsx("span",{className:"line-clamp-2",children:s.description})]})]}),e.jsx(h,{variant:"shield",size:"sm",className:"w-full",onClick:()=>g(s.id),disabled:l===s.id,leftIcon:l===s.id?e.jsx(f,{className:"w-4 h-4 animate-spin"}):e.jsx(L,{className:"w-4 h-4"}),children:l===s.id?"Claiming...":"Claim & Create Lead"})]},s.id))})]})}export{I as default};
