import{j as e}from"./vendor-query-D5ml2kdZ.js";import{r as d}from"./vendor-react-C8VcOkCS.js";import{b as j,u as S}from"./index-BZEM9EbM.js";import{B as k}from"./Badge-8fS5vckW.js";import{ax as E,as as $,L as F,t as T,a2 as _,D,a3 as P,ae as C,an as q,F as R,m as I,aD as U,ad as N,X as L}from"./vendor-ui-tJ0aMxU9.js";const p={async getClaims(t){const o=new URLSearchParams;t?.status&&o.set("status",t.status),t?.type&&o.set("type",t.type),t?.page&&o.set("page",String(t.page)),t?.per_page&&o.set("per_page",String(t.per_page));const r=o.toString();return j.get(`/claims${r?`?${r}`:""}`)},async getClaim(t){return j.get(`/claims/${t}`)},async fileClaim(t){return j.post("/claims",t)},async updateStatus(t,o){return j.put(`/claims/${t}/status`,o)},async addNote(t,o){return j.post(`/claims/${t}/notes`,{description:o})}},z=[{value:"",label:"All Statuses"},{value:"reported",label:"Reported"},{value:"under_review",label:"Under Review"},{value:"investigating",label:"Investigating"},{value:"approved",label:"Approved"},{value:"denied",label:"Denied"},{value:"settled",label:"Settled"},{value:"closed",label:"Closed"}],A=[{value:"",label:"All Types"},{value:"property_damage",label:"Property Damage"},{value:"liability",label:"Liability"},{value:"auto_collision",label:"Auto Collision"},{value:"auto_comprehensive",label:"Auto Comprehensive"},{value:"health",label:"Health"},{value:"life",label:"Life"},{value:"other",label:"Other"}],y={reported:{variant:"info",icon:q},under_review:{variant:"warning",icon:C},investigating:{variant:"shield",icon:C},approved:{variant:"success",icon:_},denied:{variant:"danger",icon:P},settled:{variant:"success",icon:D},closed:{variant:"outline",icon:_}};function B({onClose:t,onFiled:o}){const[r,c]=d.useState({policy_id:"",type:"",date_of_loss:"",description:"",location:"",estimated_amount:""}),[i,m]=d.useState(!1),[h,x]=d.useState(""),u=async a=>{a.preventDefault(),x(""),m(!0);try{await p.fileClaim({policy_id:Number(r.policy_id),type:r.type,date_of_loss:r.date_of_loss,description:r.description,location:r.location||void 0,estimated_amount:r.estimated_amount?Number(r.estimated_amount):void 0}),o()}catch(n){x(n instanceof Error?n.message:"Failed to file claim")}finally{m(!1)}};return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",onClick:t,children:e.jsxs("div",{className:"bg-white rounded-2xl w-full max-w-lg mx-4 max-h-[90vh] overflow-y-auto",onClick:a=>a.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-slate-200",children:[e.jsx("h2",{className:"text-lg font-bold text-slate-900",children:"File a Claim"}),e.jsx("button",{onClick:t,className:"p-1 hover:bg-slate-100 rounded-lg",children:e.jsx(L,{className:"w-5 h-5 text-slate-400"})})]}),e.jsxs("form",{onSubmit:u,className:"p-6 space-y-4",children:[h&&e.jsx("div",{className:"p-3 rounded-xl bg-red-50 text-red-600 text-sm",children:h}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Policy ID"}),e.jsx("input",{type:"number",value:r.policy_id,onChange:a=>c(n=>({...n,policy_id:a.target.value})),className:"w-full rounded-xl border border-slate-200 px-3 py-2.5 text-sm focus:outline-none focus:ring-2 focus:ring-shield-500",placeholder:"Enter policy ID",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Claim Type"}),e.jsxs("select",{value:r.type,onChange:a=>c(n=>({...n,type:a.target.value})),className:"w-full rounded-xl border border-slate-200 px-3 py-2.5 text-sm focus:outline-none focus:ring-2 focus:ring-shield-500",required:!0,children:[e.jsx("option",{value:"",children:"Select type..."}),A.filter(a=>a.value).map(a=>e.jsx("option",{value:a.value,children:a.label},a.value))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Date of Loss"}),e.jsx("input",{type:"date",value:r.date_of_loss,onChange:a=>c(n=>({...n,date_of_loss:a.target.value})),className:"w-full rounded-xl border border-slate-200 px-3 py-2.5 text-sm focus:outline-none focus:ring-2 focus:ring-shield-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Description"}),e.jsx("textarea",{value:r.description,onChange:a=>c(n=>({...n,description:a.target.value})),className:"w-full rounded-xl border border-slate-200 px-3 py-2.5 text-sm focus:outline-none focus:ring-2 focus:ring-shield-500",rows:3,placeholder:"Describe what happened...",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Location (optional)"}),e.jsx("input",{type:"text",value:r.location,onChange:a=>c(n=>({...n,location:a.target.value})),className:"w-full rounded-xl border border-slate-200 px-3 py-2.5 text-sm focus:outline-none focus:ring-2 focus:ring-shield-500",placeholder:"Where did the incident occur?"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Estimated Amount (optional)"}),e.jsx("input",{type:"number",step:"0.01",value:r.estimated_amount,onChange:a=>c(n=>({...n,estimated_amount:a.target.value})),className:"w-full rounded-xl border border-slate-200 px-3 py-2.5 text-sm focus:outline-none focus:ring-2 focus:ring-shield-500",placeholder:"$0.00"})]}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsx("button",{type:"button",onClick:t,className:"flex-1 px-4 py-2.5 rounded-xl border border-slate-200 text-sm font-medium text-slate-600 hover:bg-slate-50",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:i,className:"flex-1 px-4 py-2.5 rounded-xl bg-gradient-to-r from-shield-600 to-confidence-600 text-white text-sm font-semibold hover:shadow-lg disabled:opacity-50",children:i?"Filing...":"File Claim"})]})]})]})})}function M({claim:t,onClose:o,onUpdated:r}){const{user:c}=S(),[i,m]=d.useState(null),[h,x]=d.useState(!0),[u,a]=d.useState(""),[n,f]=d.useState(!1);d.useEffect(()=>{p.getClaim(t.id).then(l=>{m(l),x(!1)}).catch(()=>{N.error("Failed to load claim details"),x(!1)})},[t.id]);const v=async()=>{if(u.trim()){f(!0);try{await p.addNote(t.id,u),a("");const l=await p.getClaim(t.id);m(l)}catch{N.error("Failed to add note")}f(!1)}},g=async l=>{try{await p.updateStatus(t.id,{status:l});const w=await p.getClaim(t.id);m(w),r()}catch{N.error("Failed to update claim status")}},b=c&&["agent","agency_owner","admin","superadmin"].includes(c.role),s=y[i?.status||"reported"]||y.reported;return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",onClick:o,children:e.jsxs("div",{className:"bg-white rounded-2xl w-full max-w-2xl mx-4 max-h-[90vh] overflow-y-auto",onClick:l=>l.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-slate-200",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-bold text-slate-900",children:i?.claim_number||t.claim_number}),e.jsxs("p",{className:"text-sm text-slate-500",children:[i?.policy?.policy_number," · ",i?.type?.replace(/_/g," ")]})]}),e.jsx("button",{onClick:o,className:"p-1 hover:bg-slate-100 rounded-lg",children:e.jsx(L,{className:"w-5 h-5 text-slate-400"})})]}),h?e.jsx("div",{className:"p-12 text-center",children:e.jsx(F,{className:"w-6 h-6 animate-spin mx-auto text-slate-400"})}):i?e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex flex-wrap gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-400 mb-1",children:"Status"}),e.jsx(k,{variant:s.variant,children:i.status.replace(/_/g," ")})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-400 mb-1",children:"Date of Loss"}),e.jsx("p",{className:"text-sm font-medium text-slate-700",children:new Date(i.date_of_loss).toLocaleDateString()})]}),i.estimated_amount&&e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-400 mb-1",children:"Estimated"}),e.jsxs("p",{className:"text-sm font-medium text-slate-700",children:["$",Number(i.estimated_amount).toLocaleString()]})]}),i.approved_amount&&e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-400 mb-1",children:"Approved"}),e.jsxs("p",{className:"text-sm font-medium text-green-700",children:["$",Number(i.approved_amount).toLocaleString()]})]}),i.settlement_amount&&e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-400 mb-1",children:"Settlement"}),e.jsxs("p",{className:"text-sm font-bold text-green-700",children:["$",Number(i.settlement_amount).toLocaleString()]})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-400 mb-1",children:"Description"}),e.jsx("p",{className:"text-sm text-slate-700",children:i.description})]}),b&&!["closed","denied"].includes(i.status)&&e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-400 mb-2",children:"Update Status"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:["under_review","investigating","approved","denied","settled","closed"].filter(l=>l!==i.status).map(l=>e.jsx("button",{onClick:()=>g(l),className:"px-3 py-1.5 rounded-lg border border-slate-200 text-xs font-medium text-slate-600 hover:bg-slate-50 capitalize",children:l.replace(/_/g," ")},l))})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-400 mb-3",children:"Activity Timeline"}),e.jsx("div",{className:"space-y-3",children:(i.activities||[]).map(l=>e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-shield-400 mt-1.5 shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm text-slate-700",children:l.description}),e.jsxs("p",{className:"text-xs text-slate-400 mt-0.5",children:[l.actor?.name||"System"," · ",new Date(l.created_at).toLocaleString()]})]})]},l.id))})]}),e.jsx("div",{className:"border-t border-slate-200 pt-4",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{value:u,onChange:l=>a(l.target.value),placeholder:"Add a note...",className:"flex-1 rounded-xl border border-slate-200 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-shield-500",onKeyDown:l=>l.key==="Enter"&&v()}),e.jsx("button",{onClick:v,disabled:!u.trim()||n,className:"px-4 py-2 rounded-xl bg-shield-600 text-white text-sm font-medium hover:bg-shield-700 disabled:opacity-50",children:n?"...":"Add"})]})})]}):null]})})}function W(){const{user:t}=S(),[o,r]=d.useState([]),[c,i]=d.useState(!0),[m,h]=d.useState(""),[x,u]=d.useState(""),[a,n]=d.useState(!1),[f,v]=d.useState(null),g=async()=>{i(!0);try{const s=await p.getClaims({status:m||void 0,type:x||void 0});r(s.data)}catch{N.error("Failed to load claims")}i(!1)};d.useEffect(()=>{g()},[m,x]);const b=t?.role==="consumer";return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:b?"My Claims":"Claims Queue"}),e.jsx("p",{className:"text-slate-500 mt-1",children:b?"Track your insurance claims":"Manage and review claims"})]}),e.jsxs("button",{onClick:()=>n(!0),className:"flex items-center gap-2 px-4 py-2.5 rounded-xl bg-gradient-to-r from-shield-600 to-confidence-600 text-white text-sm font-semibold hover:shadow-lg transition-all",children:[e.jsx(E,{className:"w-4 h-4"})," File Claim"]})]}),e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx($,{className:"w-4 h-4 text-slate-400"}),e.jsx("select",{value:m,onChange:s=>h(s.target.value),className:"rounded-xl border border-slate-200 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-shield-500",children:z.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))})]}),e.jsx("select",{value:x,onChange:s=>u(s.target.value),className:"rounded-xl border border-slate-200 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-shield-500",children:A.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))})]}),c?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx(F,{className:"w-6 h-6 animate-spin text-slate-400"})}):o.length===0?e.jsxs("div",{className:"text-center py-16 bg-white rounded-2xl border border-slate-200",children:[e.jsx(T,{className:"w-10 h-10 text-slate-300 mx-auto mb-3"}),e.jsx("p",{className:"text-slate-500 font-medium",children:"No claims found"}),e.jsx("p",{className:"text-sm text-slate-400 mt-1",children:b?"File a claim when you need to report an incident":"No claims match your filters"})]}):e.jsx("div",{className:"space-y-3",children:o.map(s=>{const l=y[s.status]||y.reported,w=l.icon;return e.jsx("div",{onClick:()=>v(s),className:"bg-white rounded-2xl border border-slate-200 p-5 hover:shadow-md hover:border-shield-200 transition-all cursor-pointer",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-slate-100 flex items-center justify-center",children:e.jsx(R,{className:"w-5 h-5 text-slate-500"})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("p",{className:"font-semibold text-slate-900",children:s.claim_number}),e.jsxs(k,{variant:l.variant,children:[e.jsx(w,{className:"w-3 h-3 mr-1"}),s.status.replace(/_/g," ")]})]}),e.jsxs("p",{className:"text-sm text-slate-500 mt-0.5",children:[s.type.replace(/_/g," ")," · ",s.policy?.policy_number||`Policy #${s.policy_id}`]})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"text-right hidden sm:block",children:[e.jsxs("div",{className:"flex items-center gap-1 text-sm text-slate-500",children:[e.jsx(I,{className:"w-3.5 h-3.5"}),new Date(s.date_of_loss).toLocaleDateString()]}),s.estimated_amount&&e.jsxs("div",{className:"flex items-center gap-1 text-sm font-medium text-slate-700 mt-0.5",children:[e.jsx(D,{className:"w-3.5 h-3.5"}),Number(s.estimated_amount).toLocaleString()]})]}),e.jsx(U,{className:"w-5 h-5 text-slate-300"})]})]})},s.id)})}),a&&e.jsx(B,{onClose:()=>n(!1),onFiled:()=>{n(!1),g()}}),f&&e.jsx(M,{claim:f,onClose:()=>v(null),onUpdated:g})]})}export{W as default};
