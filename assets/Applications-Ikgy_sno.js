import{j as e}from"./vendor-query-D5ml2kdZ.js";import{r as c}from"./vendor-react-C8VcOkCS.js";import{b as d,C as x,I as y,S as C,B as g}from"./index-8sQqf4Gi.js";import{B as $}from"./Badge-CDix051U.js";import{ae as k,L as A,F as w,a5 as L,aa as b,a3 as B,a6 as D,an as E}from"./vendor-ui-tJ0aMxU9.js";const R={async list(s){const l=new URLSearchParams;s?.status&&l.set("status",s.status),s?.search&&l.set("search",s.search);const n=l.toString(),o=await d.get(`/applications${n?`?${n}`:""}`),i=o.data||[];return{items:i,total:o.total||i.length,counts:{total:o.total||i.length,draft:i.filter(a=>a.status==="draft").length,submitted:i.filter(a=>a.status==="submitted").length,under_review:i.filter(a=>a.status==="under_review").length,approved:i.filter(a=>a.status==="approved").length,declined:i.filter(a=>a.status==="declined").length,bound:i.filter(a=>a.status==="bound").length}}},async get(s){return d.get(`/applications/${s}`)},async create(s){return d.post("/applications",s)},async update(s,l){return d.put(`/applications/${s}`,l)},async submit(s){return d.post(`/applications/${s}/submit`)},async updateStatus(s,l,n){return d.put(`/applications/${s}/status`,{status:l,decision_notes:n})},async uploadDocument(s,l){return d.upload(`/applications/${s}/documents`,l)}},u={draft:{label:"Draft",variant:"default",icon:e.jsx(w,{className:"w-3.5 h-3.5"})},submitted:{label:"Submitted",variant:"shield",icon:e.jsx(E,{className:"w-3.5 h-3.5"})},under_review:{label:"Under Review",variant:"warning",icon:e.jsx(D,{className:"w-3.5 h-3.5"})},approved:{label:"Approved",variant:"success",icon:e.jsx(b,{className:"w-3.5 h-3.5"})},declined:{label:"Declined",variant:"danger",icon:e.jsx(B,{className:"w-3.5 h-3.5"})},bound:{label:"Bound",variant:"success",icon:e.jsx(b,{className:"w-3.5 h-3.5"})}},F=[{value:"",label:"All Statuses"},{value:"draft",label:"Draft"},{value:"submitted",label:"Submitted"},{value:"under_review",label:"Under Review"},{value:"approved",label:"Approved"},{value:"declined",label:"Declined"},{value:"bound",label:"Bound"}];function O(){const[s,l]=c.useState(""),[n,o]=c.useState(""),[i,a]=c.useState([]),[_,S]=c.useState({total:0,draft:0,submitted:0,under_review:0,approved:0,declined:0,bound:0}),[p,h]=c.useState(!0),[m,f]=c.useState("");c.useEffect(()=>{j()},[n]);const j=async()=>{try{h(!0),f("");const t=await R.list(n?{status:n}:void 0);a(t.items),S(t.counts)}catch(t){f(t instanceof Error?t.message:"Failed to load applications")}finally{h(!1)}},N=i.filter(t=>{if(!s)return!0;const r=s.toLowerCase();return(t.applicant_data?`${t.applicant_data.first_name||""} ${t.applicant_data.last_name||""}`:t.user?.name||"").toLowerCase().includes(r)||t.reference.toLowerCase().includes(r)});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:"Applications"}),e.jsx("p",{className:"text-slate-500 mt-1",children:"Track insurance applications through the pipeline"})]}),e.jsx("div",{className:"grid grid-cols-3 lg:grid-cols-6 gap-4",children:Object.entries(u).map(([t,r])=>e.jsxs(x,{className:"p-4 text-center",children:[e.jsx("p",{className:"text-xl font-bold text-slate-900",children:_[t]||0}),e.jsx("p",{className:"text-xs text-slate-500 capitalize",children:r.label})]},t))}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx(y,{placeholder:"Search by name or reference...",value:s,onChange:t=>l(t.target.value),leftIcon:e.jsx(k,{className:"w-5 h-5"})})}),e.jsx("div",{className:"w-48",children:e.jsx(C,{options:F,value:n,onChange:t=>o(t.target.value)})})]}),m&&e.jsxs(x,{className:"p-6 text-center",children:[e.jsx("p",{className:"text-red-500",children:m}),e.jsx(g,{variant:"outline",size:"sm",className:"mt-2",onClick:j,children:"Retry"})]}),p&&e.jsxs(x,{className:"p-12 text-center",children:[e.jsx(A,{className:"w-8 h-8 animate-spin text-shield-500 mx-auto"}),e.jsx("p",{className:"text-slate-500 mt-2",children:"Loading applications..."})]}),!p&&!m&&e.jsx(x,{children:N.length===0?e.jsxs("div",{className:"p-12 text-center",children:[e.jsx(w,{className:"w-12 h-12 text-slate-300 mx-auto mb-3"}),e.jsx("p",{className:"text-slate-500",children:"No applications found"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-slate-100",children:[e.jsx("th",{className:"text-left text-xs font-medium text-slate-500 uppercase tracking-wider p-4",children:"Reference"}),e.jsx("th",{className:"text-left text-xs font-medium text-slate-500 uppercase tracking-wider p-4",children:"Applicant"}),e.jsx("th",{className:"text-left text-xs font-medium text-slate-500 uppercase tracking-wider p-4",children:"Type"}),e.jsx("th",{className:"text-left text-xs font-medium text-slate-500 uppercase tracking-wider p-4",children:"Carrier"}),e.jsx("th",{className:"text-left text-xs font-medium text-slate-500 uppercase tracking-wider p-4",children:"Premium"}),e.jsx("th",{className:"text-left text-xs font-medium text-slate-500 uppercase tracking-wider p-4",children:"Status"}),e.jsx("th",{className:"text-left text-xs font-medium text-slate-500 uppercase tracking-wider p-4",children:"Date"}),e.jsx("th",{className:"text-right text-xs font-medium text-slate-500 uppercase tracking-wider p-4",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-50",children:N.map(t=>{const r=u[t.status]||u.draft,v=t.applicant_data?`${t.applicant_data.first_name||""} ${t.applicant_data.last_name||""}`.trim():t.user?.name||"-";return e.jsxs("tr",{className:"hover:bg-slate-50",children:[e.jsx("td",{className:"p-4 font-mono text-sm text-shield-600",children:t.reference}),e.jsx("td",{className:"p-4 font-medium text-slate-900",children:v}),e.jsx("td",{className:"p-4 text-sm text-slate-700 capitalize",children:(t.insurance_type||"").replace(/_/g," ")}),e.jsx("td",{className:"p-4 text-sm text-slate-700",children:t.carrier_name}),e.jsxs("td",{className:"p-4 text-sm font-medium text-slate-900",children:["$",t.monthly_premium,"/mo"]}),e.jsx("td",{className:"p-4",children:e.jsx($,{variant:r.variant,children:r.label})}),e.jsx("td",{className:"p-4 text-sm text-slate-500",children:t.submitted_at||t.created_at?.split("T")[0]||"-"}),e.jsx("td",{className:"p-4 text-right",children:e.jsx(g,{variant:"ghost",size:"sm",children:e.jsx(L,{className:"w-4 h-4"})})})]},t.id)})})]})})})]})}export{O as default};
