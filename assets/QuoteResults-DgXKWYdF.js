import{j as e}from"./vendor-query-12hh4XMF.js";import{u as ee,c as se,r,L as n}from"./vendor-react-DLBQSjpP.js";import{C as f,B as l,I as c}from"./Textarea-PvxY7cN2.js";import{B as te}from"./Badge-BbdvQpL-.js";import{u as ae,a as le}from"./index-BwvgEM7m.js";import{q as re}from"./quotes-CQ5Ewz-0.js";import{S as L,o as ie,e as ne,p as ce,q as oe,A as g,m as Q,l as de,k as E,j as P,P as me}from"./vendor-ui-DhJfMhsX.js";function ve(){const o=ee(),q=se(),{isAuthenticated:u}=ae(),[v,M]=r.useState(null),[$,p]=r.useState(!1),[z,N]=r.useState(!1),[w,b]=r.useState(!1),[a,m]=r.useState({first_name:"",last_name:"",email:"",phone:""}),[y,B]=r.useState(!1),[i,_]=r.useState({password:"",password_confirmation:""}),[R,C]=r.useState(!1),[j,U]=r.useState(!1),[S,x]=r.useState(""),h=o.state?.quotes||[],k=o.state?.quoteRequestId,T=o.state?.insuranceType||"auto",W=o.state?.coverageLevel||"standard",Y=o.state?.zipCode||"",I=[...h].sort((s,t)=>s.is_recommended&&!t.is_recommended?-1:!s.is_recommended&&t.is_recommended?1:parseFloat(s.monthly_premium)-parseFloat(t.monthly_premium)),D=h.length>0?Math.min(...h.map(s=>parseFloat(s.monthly_premium))):0,G=async()=>{if(!(!a.first_name||!a.email)){N(!0);try{await re.saveContact(k,{first_name:a.first_name,last_name:a.last_name,email:a.email,phone:a.phone||void 0}),b(!0)}catch{b(!0)}finally{N(!1)}}},J=async()=>{if(i.password.length<8){x("Password must be at least 8 characters");return}if(i.password!==i.password_confirmation){x("Passwords do not match");return}C(!0),x("");try{const s=await le.registerFromQuote({name:`${a.first_name} ${a.last_name}`.trim(),email:a.email,password:i.password,password_confirmation:i.password_confirmation,phone:a.phone||void 0,quote_request_id:k});localStorage.setItem("auth_token",s.token),U(!0)}catch(s){x(s instanceof Error?s.message:"Registration failed")}finally{C(!1)}},V=(s,t)=>{t.stopPropagation(),u||j?q("/marketplace",{state:{selectedQuote:s}}):(p(!0),document.getElementById("save-section")?.scrollIntoView({behavior:"smooth"}))};return h.length===0?e.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center",children:e.jsx(f,{className:"max-w-md mx-auto",children:e.jsxs("div",{className:"p-8 text-center",children:[e.jsx(L,{className:"w-12 h-12 text-shield-400 mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-bold text-slate-900 mb-2",children:"No Quotes Available"}),e.jsx("p",{className:"text-slate-500 mb-6",children:"We couldn't find matching quotes for your criteria. Try adjusting your search."}),e.jsx(n,{to:"/calculator",children:e.jsx(l,{variant:"shield",children:"Try Again"})})]})})}):e.jsxs("div",{className:"min-h-screen bg-slate-50",children:[e.jsx("nav",{className:"bg-white border-b border-slate-100",children:e.jsxs("div",{className:"max-w-6xl mx-auto px-6 py-4 flex items-center justify-between",children:[e.jsxs(n,{to:"/",className:"flex items-center gap-2.5",children:[e.jsx("div",{className:"w-9 h-9 rounded-xl gradient-shield flex items-center justify-center",children:e.jsx(L,{className:"w-5 h-5 text-white"})}),e.jsx("span",{className:"text-xl font-bold text-slate-900",children:"InsureFlow"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(n,{to:"/calculator",children:e.jsx(l,{variant:"ghost",size:"sm",leftIcon:e.jsx(ie,{className:"w-4 h-4"}),children:"New Quote"})}),u||j?e.jsx(n,{to:"/dashboard",children:e.jsx(l,{variant:"outline",size:"sm",children:"My Dashboard"})}):e.jsx(n,{to:"/marketplace",children:e.jsx(l,{variant:"outline",size:"sm",children:"Find an Agent"})})]})]})}),e.jsxs("div",{className:"max-w-6xl mx-auto px-6 py-10",children:[e.jsxs("div",{className:"text-center mb-10",children:[e.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 rounded-full bg-savings-50 text-savings-700 text-sm font-medium mb-4",children:[e.jsx(ne,{className:"w-4 h-4"}),I.length," quotes found — no account needed"]}),e.jsx("h1",{className:"text-3xl font-bold text-slate-900",children:"Your Insurance Quotes"}),e.jsx("p",{className:"text-slate-500 mt-2",children:"Compare rates side-by-side from top-rated carriers"})]}),e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 p-6 mb-8 flex flex-wrap items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-slate-500",children:"Lowest Monthly Premium"}),e.jsxs("p",{className:"text-2xl font-bold text-savings-600",children:["$",D.toFixed(0),"/mo"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-slate-500",children:"Insurance Type"}),e.jsx("p",{className:"text-lg font-semibold text-slate-900 capitalize",children:T})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-slate-500",children:"Coverage Level"}),e.jsx("p",{className:"text-lg font-semibold text-slate-900 capitalize",children:W})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-slate-500",children:"ZIP Code"}),e.jsx("p",{className:"text-lg font-semibold text-slate-900",children:Y})]})]}),e.jsx("div",{className:"space-y-4",children:I.map(s=>{const t=s.carrier_product?.carrier,F=t?.name||"Insurance Carrier",Z=F.split(" ").map(d=>d[0]).join("").slice(0,2).toUpperCase(),A=t?.am_best_rating,H=parseFloat(s.monthly_premium),K=parseFloat(s.annual_premium),O=parseFloat(s.deductible);return e.jsx(f,{className:`transition-all duration-200 cursor-pointer ${v===s.id?"ring-2 ring-shield-500":""} ${s.is_recommended?"border-shield-200 bg-shield-50/30":""}`,onClick:()=>M(s.id),children:e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center gap-6",children:[e.jsxs("div",{className:"flex items-center gap-4 lg:w-56",children:[e.jsx("div",{className:"w-14 h-14 rounded-xl bg-shield-100 text-shield-700 flex items-center justify-center text-lg font-bold",children:Z}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-slate-900",children:F}),A&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ce,{className:"w-3.5 h-3.5 text-amber-500"}),e.jsxs("span",{className:"text-sm text-slate-600",children:["AM Best: ",A]})]})]}),s.is_recommended&&e.jsx(te,{variant:"shield",className:"ml-auto lg:ml-0",children:"Best Value"})]}),e.jsxs("div",{className:"flex-1 grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 uppercase tracking-wider",children:"Monthly"}),e.jsxs("p",{className:"text-xl font-bold text-slate-900",children:["$",H.toFixed(0)]}),e.jsxs("p",{className:"text-xs text-slate-400",children:["$",K.toFixed(0),"/yr"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 uppercase tracking-wider",children:"Deductible"}),e.jsxs("p",{className:"text-xl font-bold text-slate-900",children:["$",O.toFixed(0)]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 uppercase tracking-wider",children:"Coverage"}),e.jsx("p",{className:"text-xl font-bold text-slate-900",children:s.coverage_limit})]})]}),e.jsx("div",{className:"lg:w-56",children:(s.features||[]).slice(0,3).map((d,X)=>e.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-600",children:[e.jsx(oe,{className:"w-3.5 h-3.5 text-savings-500 flex-shrink-0"}),d]},X))}),e.jsx("div",{className:"lg:w-40",children:e.jsx(l,{variant:v===s.id?"shield":"outline",className:"w-full",rightIcon:e.jsx(g,{className:"w-4 h-4"}),onClick:d=>V(s,d),children:"Select"})})]})})},s.id)})}),!u&&e.jsx("div",{id:"save-section",children:e.jsx(f,{className:"mt-10 border-shield-200 bg-gradient-to-r from-shield-50/50 to-blue-50/50",children:e.jsx("div",{className:"p-8",children:j?e.jsxs("div",{className:"text-center",children:[e.jsx(Q,{className:"w-12 h-12 text-savings-500 mx-auto mb-3"}),e.jsx("h3",{className:"text-xl font-bold text-slate-900 mb-1",children:"You're all set!"}),e.jsx("p",{className:"text-slate-500 mb-5",children:"Your account is ready. Track your quotes, apply for policies, and connect with agents."}),e.jsxs("div",{className:"flex items-center justify-center gap-3",children:[e.jsx(n,{to:"/dashboard",children:e.jsx(l,{variant:"shield",rightIcon:e.jsx(g,{className:"w-4 h-4"}),children:"Go to Dashboard"})}),e.jsx(n,{to:"/marketplace",children:e.jsx(l,{variant:"outline",children:"Find an Agent"})})]})]}):w&&!y?e.jsxs("div",{className:"text-center",children:[e.jsx(Q,{className:"w-12 h-12 text-savings-500 mx-auto mb-3"}),e.jsx("h3",{className:"text-xl font-bold text-slate-900 mb-1",children:"Quotes Saved!"}),e.jsx("p",{className:"text-slate-500 mb-5",children:"Create a free account to track your quotes, apply for policies, and get matched with agents."}),e.jsxs("div",{className:"flex items-center justify-center gap-3",children:[e.jsx(l,{variant:"shield",onClick:()=>B(!0),leftIcon:e.jsx(de,{className:"w-4 h-4"}),children:"Create Free Account"}),e.jsx(n,{to:"/marketplace",children:e.jsx(l,{variant:"outline",children:"Maybe Later"})})]})]}):w&&y?e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-1 text-center",children:"Create your free account"}),e.jsx("p",{className:"text-sm text-slate-500 mb-4 text-center",children:"Just pick a password — we already have your details from saving your quotes."}),e.jsxs("div",{className:"max-w-sm mx-auto space-y-4",children:[e.jsxs("div",{className:"p-3 rounded-lg bg-slate-50 border border-slate-200 text-sm text-slate-600",children:[e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Name:"})," ",a.first_name," ",a.last_name]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Email:"})," ",a.email]})]}),S&&e.jsx("div",{className:"p-3 rounded-lg bg-red-50 text-red-700 text-sm",children:S}),e.jsx(c,{label:"Password",type:"password",placeholder:"Create a password (8+ characters)",value:i.password,onChange:s=>_(t=>({...t,password:s.target.value})),leftIcon:e.jsx(E,{className:"w-4 h-4"})}),e.jsx(c,{label:"Confirm Password",type:"password",placeholder:"Confirm your password",value:i.password_confirmation,onChange:s=>_(t=>({...t,password_confirmation:s.target.value})),leftIcon:e.jsx(E,{className:"w-4 h-4"})}),e.jsx(l,{variant:"shield",className:"w-full",onClick:J,isLoading:R,disabled:!i.password||!i.password_confirmation,children:"Create Account"}),e.jsx("p",{className:"text-xs text-slate-400 text-center",children:"Free forever for consumers. No credit card required."})]})]}):$?e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-4 text-center",children:"Enter your details to save these quotes"}),e.jsxs("div",{className:"max-w-lg mx-auto space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx(c,{label:"First Name",placeholder:"John",value:a.first_name,onChange:s=>m(t=>({...t,first_name:s.target.value}))}),e.jsx(c,{label:"Last Name",placeholder:"Smith",value:a.last_name,onChange:s=>m(t=>({...t,last_name:s.target.value}))})]}),e.jsx(c,{label:"Email",type:"email",placeholder:"you@example.com",value:a.email,onChange:s=>m(t=>({...t,email:s.target.value}))}),e.jsx(c,{label:"Phone (optional)",type:"tel",placeholder:"(555) 123-4567",value:a.phone,onChange:s=>m(t=>({...t,phone:s.target.value}))}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(l,{variant:"outline",className:"flex-1",onClick:()=>p(!1),children:"Cancel"}),e.jsx(l,{variant:"shield",className:"flex-1",onClick:G,isLoading:z,disabled:!a.first_name||!a.email,children:"Save My Quotes"})]}),e.jsx("p",{className:"text-xs text-slate-400 text-center",children:"We won't spam you. Your info is only used to save and email your quotes."})]})]}):e.jsxs("div",{className:"text-center",children:[e.jsx(P,{className:"w-10 h-10 text-shield-500 mx-auto mb-3"}),e.jsx("h3",{className:"text-xl font-bold text-slate-900 mb-1",children:"Want to save these quotes?"}),e.jsx("p",{className:"text-slate-500 mb-5",children:"Get your quotes emailed to you — valid for 30 days. No account required."}),e.jsx(l,{variant:"shield",onClick:()=>p(!0),leftIcon:e.jsx(P,{className:"w-4 h-4"}),children:"Email My Quotes"})]})})})}),e.jsxs("div",{className:"mt-10 text-center",children:[e.jsx("p",{className:"text-slate-500 mb-4",children:"Want help choosing the right policy? Connect with a licensed agent."}),e.jsxs("div",{className:"flex items-center justify-center gap-4",children:[e.jsx(n,{to:"/marketplace",children:e.jsx(l,{variant:"shield",rightIcon:e.jsx(g,{className:"w-4 h-4"}),children:"Find an Agent"})}),e.jsx(l,{variant:"outline",leftIcon:e.jsx(me,{className:"w-4 h-4"}),children:"Call 1-800-INSURE"})]})]})]})]})}export{ve as default};
