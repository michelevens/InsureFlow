import{j as e}from"./vendor-query-D5ml2kdZ.js";import{r as c}from"./vendor-react-C8VcOkCS.js";import{ax as P,ai as L,a8 as E,V as D,an as R,u as $,m as F,ad as g}from"./vendor-ui-tJ0aMxU9.js";import{b as d,B as x,C as S,I as k}from"./index-BZEM9EbM.js";import{B as v}from"./Badge-8fS5vckW.js";import{M as A}from"./Modal-Cn8_xSIn.js";function U(i){if(!i)return"";const r=Object.entries(i).filter(([,o])=>o!==void 0);return r.length?"?"+new URLSearchParams(r.map(([o,h])=>[o,String(h)])).toString():""}const N={list:i=>d.get(`/events${U(i)}`),show:i=>d.get(`/events/${i}`),create:i=>d.post("/events",i),update:(i,r)=>d.put(`/events/${i}`,r),destroy:i=>d.delete(`/events/${i}`),register:i=>d.post(`/events/${i}/register`),cancelRegistration:i=>d.post(`/events/${i}/cancel-registration`),markAttended:(i,r)=>d.post(`/events/${i}/mark-attended`,{user_ids:r}),upcoming:()=>d.get("/events/upcoming")},f={webinar:{label:"Webinar",variant:"info",icon:D},in_person:{label:"In-Person",variant:"success",icon:E},hybrid:{label:"Hybrid",variant:"warning",icon:L}};function V(){const[i,r]=c.useState([]),[o,h]=c.useState([]),[y,w]=c.useState(!0),[C,j]=c.useState(!1),[a,m]=c.useState(null);c.useEffect(()=>{(async()=>{w(!0);try{const[n,t]=await Promise.all([N.list({status:"published"}),N.upcoming()]);r(n.data),h(t)}catch{g.error("Failed to load events")}finally{w(!1)}})()},[]);const u=async s=>{try{await N.register(s),g.success("Successfully registered for event"),r(n=>n.map(t=>t.id===s?{...t,is_registered:!0,registration_count:t.registration_count+1}:t)),h(n=>n.map(t=>t.id===s?{...t,is_registered:!0,registration_count:t.registration_count+1}:t))}catch{g.error("Failed to register for event")}},_=async s=>{try{await N.cancelRegistration(s),g.success("Event registration cancelled"),r(n=>n.map(t=>t.id===s?{...t,is_registered:!1,registration_count:t.registration_count-1}:t)),h(n=>n.map(t=>t.id===s?{...t,is_registered:!1,registration_count:t.registration_count-1}:t))}catch{g.error("Failed to cancel registration")}},p=s=>new Date(s).toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric",hour:"numeric",minute:"2-digit"});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:"Events & Webinars"}),e.jsx("p",{className:"text-slate-500 mt-1",children:"Industry events, training, and networking opportunities"})]}),e.jsxs(x,{variant:"shield",onClick:()=>j(!0),children:[e.jsx(P,{className:"w-4 h-4 mr-1"})," Create Event"]})]}),o.length>0&&e.jsxs("div",{children:[e.jsx("h2",{className:"text-sm font-medium text-slate-500 uppercase mb-3",children:"Coming Up Next"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:o.slice(0,3).map(s=>{const n=f[s.type]||f.webinar;return e.jsxs(S,{className:"p-5 hover:shadow-md transition-all cursor-pointer",onClick:()=>m(s),children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(v,{variant:n.variant,children:n.label}),s.is_registered&&e.jsx(v,{variant:"success",children:"Registered"})]}),e.jsx("h3",{className:"font-bold text-slate-900 mb-1",children:s.title}),e.jsxs("div",{className:"space-y-1 text-xs text-slate-500",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(R,{className:"w-3 h-3"})," ",p(s.start_at)]}),s.location&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(E,{className:"w-3 h-3"})," ",s.location]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx($,{className:"w-3 h-3"})," ",s.registration_count," registered",s.max_attendees?` / ${s.max_attendees} max`:""]})]})]},s.id)})})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-sm font-medium text-slate-500 uppercase mb-3",children:"All Events"}),y?e.jsx(S,{className:"p-8 text-center",children:e.jsx("div",{className:"w-8 h-8 border-4 border-shield-200 border-t-shield-600 rounded-full animate-spin mx-auto"})}):i.length===0?e.jsxs(S,{className:"p-12 text-center",children:[e.jsx(F,{className:"w-12 h-12 text-slate-300 mx-auto mb-3"}),e.jsx("p",{className:"text-slate-500 mb-4",children:"No events scheduled"}),e.jsxs(x,{variant:"shield",onClick:()=>j(!0),children:[e.jsx(P,{className:"w-4 h-4 mr-1"})," Create First Event"]})]}):e.jsx("div",{className:"space-y-3",children:i.map(s=>{const n=f[s.type]||f.webinar,t=new Date(s.end_at)<new Date;return e.jsx(S,{className:`p-4 ${t?"opacity-60":"hover:shadow-md"} transition-all cursor-pointer`,onClick:()=>m(s),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-shield-50 flex items-center justify-center",children:e.jsx(n.icon,{className:"w-5 h-5 text-shield-600"})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"font-medium text-slate-900",children:s.title}),e.jsx(v,{variant:n.variant,children:n.label}),s.is_registered&&e.jsx(v,{variant:"success",children:"Registered"})]}),e.jsxs("div",{className:"flex items-center gap-3 text-xs text-slate-500 mt-1",children:[e.jsx("span",{children:p(s.start_at)}),s.location&&e.jsx("span",{children:s.location}),e.jsxs("span",{children:[s.registration_count," attendees"]})]})]})]}),!t&&(s.is_registered?e.jsx(x,{variant:"outline",size:"sm",onClick:b=>{b.stopPropagation(),_(s.id)},children:"Cancel"}):e.jsx(x,{variant:"shield",size:"sm",onClick:b=>{b.stopPropagation(),u(s.id)},children:"Register"}))]})},s.id)})})]}),a&&e.jsx(A,{isOpen:!0,onClose:()=>m(null),title:a.title,size:"md",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(v,{variant:f[a.type]?.variant||"info",children:f[a.type]?.label||a.type}),e.jsx(v,{variant:a.status==="published"?"success":"default",children:a.status})]}),e.jsx("p",{className:"text-sm text-slate-700",children:a.description}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 text-slate-600",children:[e.jsx(R,{className:"w-4 h-4"})," ",p(a.start_at)," â€” ",p(a.end_at)]}),a.location&&e.jsxs("div",{className:"flex items-center gap-2 text-slate-600",children:[e.jsx(E,{className:"w-4 h-4"})," ",a.location]}),a.meeting_url&&e.jsxs("div",{className:"flex items-center gap-2 text-slate-600",children:[e.jsx(D,{className:"w-4 h-4"})," ",e.jsx("a",{href:a.meeting_url,target:"_blank",rel:"noopener noreferrer",className:"text-shield-600 hover:underline",children:"Join meeting"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-slate-600",children:[e.jsx($,{className:"w-4 h-4"})," ",a.registration_count," registered",a.max_attendees?` / ${a.max_attendees}`:""]})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[e.jsx(x,{variant:"ghost",onClick:()=>m(null),children:"Close"}),a.is_registered?e.jsx(x,{variant:"outline",onClick:()=>{_(a.id),m(null)},children:"Cancel Registration"}):e.jsx(x,{variant:"shield",onClick:()=>{u(a.id),m(null)},children:"Register Now"})]})]})}),C&&e.jsx(z,{onClose:()=>j(!1),onCreated:s=>{r(n=>[s,...n]),j(!1)}})]})}function z({onClose:i,onCreated:r}){const[o,h]=c.useState(""),[y,w]=c.useState(""),[C,j]=c.useState("webinar"),[a,m]=c.useState(""),[u,_]=c.useState(""),[p,s]=c.useState(""),[n,t]=c.useState(!1),b=async()=>{if(!(!o||!a||!u)){t(!0);try{const l=await N.create({title:o,description:y,type:C,start_at:a,end_at:u,location:p||null,status:"published"});g.success("Event created successfully"),r(l)}catch{g.error("Failed to create event")}finally{t(!1)}}};return e.jsx(A,{isOpen:!0,onClose:i,title:"Create Event",size:"md",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(k,{label:"Title",placeholder:"Product Launch Webinar",value:o,onChange:l=>h(l.target.value)}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 block mb-1",children:"Description"}),e.jsx("textarea",{value:y,onChange:l=>w(l.target.value),className:"w-full h-20 text-sm border border-slate-200 rounded-lg p-3 focus:ring-2 focus:ring-shield-500 focus:border-shield-500",placeholder:"Event details..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 block mb-1",children:"Type"}),e.jsxs("select",{value:C,onChange:l=>j(l.target.value),className:"w-full text-sm border border-slate-200 rounded-lg px-3 py-2",children:[e.jsx("option",{value:"webinar",children:"Webinar"}),e.jsx("option",{value:"in_person",children:"In-Person"}),e.jsx("option",{value:"hybrid",children:"Hybrid"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx(k,{label:"Start",type:"datetime-local",value:a,onChange:l=>m(l.target.value)}),e.jsx(k,{label:"End",type:"datetime-local",value:u,onChange:l=>_(l.target.value)})]}),e.jsx(k,{label:"Location",placeholder:"Optional",value:p,onChange:l=>s(l.target.value)}),e.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[e.jsx(x,{variant:"ghost",onClick:i,children:"Cancel"}),e.jsx(x,{variant:"shield",onClick:b,disabled:n||!o||!a||!u,children:n?"Creating...":"Create Event"})]})]})})}export{V as default};
