import{j as e}from"./vendor-query-D5ml2kdZ.js";import{b as de,u as me,r as i,L as d}from"./vendor-react-C8VcOkCS.js";import{u as xe,C as F,B as r,I as h,a as he}from"./index-CyWO3JYX.js";import{B as V}from"./Badge-DV1ZXp4T.js";import{q as ue}from"./quotes-48w1IwBU.js";import{a1 as pe,A as je,S as ge,ao as fe,ap as Ne,aq as ve,x as W,ac as Y,a7 as $,n as be,aa as G,a0 as we,_ as J,E as Z,ar as ye}from"./vendor-ui-tJ0aMxU9.js";function _e(c,j){const x=c>120?-Math.round(c*.05):0,b=c-5-x;return{baseRate:Math.max(b,0),policyFee:5,multiPolicyDiscount:x,monthlyTotal:c,annualTotal:j,annualSavings:Math.round(c*12-j)}}function Me(){const c=de(),j=me(),{isAuthenticated:g}=xe(),[x,b]=i.useState(null),[H,w]=i.useState(!1),[O,I]=i.useState(!1),[M,P]=i.useState(!1),[a,f]=i.useState({first_name:"",last_name:"",email:"",phone:""}),[A,K]=i.useState(!1),[o,L]=i.useState({password:"",password_confirmation:""}),[X,B]=i.useState(!1),[y,q]=i.useState(!1),[Q,N]=i.useState(""),[_,ee]=i.useState("recommended"),[v,D]=i.useState("cards"),[C,se]=i.useState(null),u=i.useMemo(()=>{if(c.state?.quotes?.length)return c.state;try{const s=localStorage.getItem("insurons_quote_results");if(s){const t=JSON.parse(s);if(t.savedAt&&Date.now()-t.savedAt<1440*60*1e3)return t;localStorage.removeItem("insurons_quote_results")}}catch{}return null},[c.state]),p=u?.quotes||[],E=u?.quoteRequestId,te=u?.insuranceType||"auto",ae=u?.coverageLevel||"standard",le=u?.zipCode||"",n=i.useMemo(()=>[...p].sort((s,t)=>{switch(_){case"price_asc":return parseFloat(s.monthly_premium)-parseFloat(t.monthly_premium);case"price_desc":return parseFloat(t.monthly_premium)-parseFloat(s.monthly_premium);case"deductible_asc":return parseFloat(s.deductible)-parseFloat(t.deductible);case"rating":{const m=s.carrier_product?.carrier?.am_best_rating||"Z",S=t.carrier_product?.carrier?.am_best_rating||"Z";return m.localeCompare(S)}default:return s.is_recommended&&!t.is_recommended?-1:!s.is_recommended&&t.is_recommended?1:parseFloat(s.monthly_premium)-parseFloat(t.monthly_premium)}}),[p,_]),re=p.length>0?Math.min(...p.map(s=>parseFloat(s.monthly_premium))):0,ie=async()=>{if(!(!a.first_name||!a.email)){I(!0);try{await ue.saveContact(E,{first_name:a.first_name,last_name:a.last_name,email:a.email,phone:a.phone||void 0}),P(!0)}catch{P(!0)}finally{I(!1)}}},ne=async()=>{if(o.password.length<8){N("Password must be at least 8 characters");return}if(o.password!==o.password_confirmation){N("Passwords do not match");return}B(!0),N("");try{const s=await he.registerFromQuote({name:`${a.first_name} ${a.last_name}`.trim(),email:a.email,password:o.password,password_confirmation:o.password_confirmation,phone:a.phone||void 0,quote_request_id:E});localStorage.setItem("auth_token",s.token),q(!0)}catch(s){N(s instanceof Error?s.message:"Registration failed")}finally{B(!1)}},R=(s,t)=>{t.stopPropagation(),g||y?j("/marketplace",{state:{selectedQuote:s}}):(w(!0),document.getElementById("save-section")?.scrollIntoView({behavior:"smooth"}))};return p.length===0?e.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center",children:e.jsx(F,{className:"max-w-md mx-auto",children:e.jsxs("div",{className:"p-8 text-center",children:[e.jsx(pe,{className:"w-12 h-12 text-shield-400 mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-bold text-slate-900 mb-2",children:"No Quotes Available"}),e.jsx("p",{className:"text-slate-500 mb-6",children:"We couldn't find matching quotes for your criteria. Try adjusting your search."}),e.jsx(d,{to:"/calculator",children:e.jsx(r,{variant:"shield",children:"Try Again"})})]})})}):e.jsxs("div",{className:"min-h-screen bg-slate-50",children:[e.jsx("nav",{className:"bg-white border-b border-slate-100",children:e.jsxs("div",{className:"max-w-6xl mx-auto px-6 py-4 flex items-center justify-between",children:[e.jsx(d,{to:"/",className:"flex items-center gap-2.5",children:e.jsx("img",{src:"/logo.png",alt:"Insurons",className:"h-16 w-auto"})}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(d,{to:"/calculator",children:e.jsx(r,{variant:"ghost",size:"sm",leftIcon:e.jsx(je,{className:"w-4 h-4"}),children:"New Quote"})}),g||y?e.jsx(d,{to:"/dashboard",children:e.jsx(r,{variant:"outline",size:"sm",children:"My Dashboard"})}):e.jsx(d,{to:"/marketplace",children:e.jsx(r,{variant:"outline",size:"sm",children:"Find an Agent"})})]})]})}),e.jsxs("div",{className:"max-w-6xl mx-auto px-6 py-10",children:[e.jsxs("div",{className:"text-center mb-10",children:[e.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 rounded-full bg-savings-50 text-savings-700 text-sm font-medium mb-4",children:[e.jsx(ge,{className:"w-4 h-4"}),n.length," quotes found — no account needed"]}),e.jsx("h1",{className:"text-3xl font-bold text-slate-900",children:"Your Insurance Quotes"}),e.jsx("p",{className:"text-slate-500 mt-2",children:"Compare rates side-by-side from top-rated carriers"})]}),e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 p-6 mb-8 flex flex-wrap items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-slate-500",children:"Lowest Monthly Premium"}),e.jsxs("p",{className:"text-2xl font-bold text-savings-600",children:["$",re.toFixed(0),"/mo"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-slate-500",children:"Insurance Type"}),e.jsx("p",{className:"text-lg font-semibold text-slate-900 capitalize",children:te})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-slate-500",children:"Coverage Level"}),e.jsx("p",{className:"text-lg font-semibold text-slate-900 capitalize",children:ae})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-slate-500",children:"ZIP Code"}),e.jsx("p",{className:"text-lg font-semibold text-slate-900",children:le})]})]}),e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("p",{className:"text-sm text-slate-500",children:[n.length," quote",n.length!==1?"s":""]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex items-center border border-slate-200 rounded-lg overflow-hidden",children:[e.jsx("button",{onClick:()=>D("cards"),className:`p-1.5 ${v==="cards"?"bg-shield-100 text-shield-700":"text-slate-400 hover:text-slate-600"}`,title:"Card view",children:e.jsx(fe,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>D("compare"),className:`p-1.5 ${v==="compare"?"bg-shield-100 text-shield-700":"text-slate-400 hover:text-slate-600"}`,title:"Comparison table",children:e.jsx(Ne,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ve,{className:"w-4 h-4 text-slate-400"}),e.jsxs("select",{value:_,onChange:s=>ee(s.target.value),className:"text-sm border border-slate-200 rounded-lg px-3 py-1.5 text-slate-700 focus:outline-none focus:ring-2 focus:ring-shield-500",children:[e.jsx("option",{value:"recommended",children:"Best Match"}),e.jsx("option",{value:"price_asc",children:"Price: Low to High"}),e.jsx("option",{value:"price_desc",children:"Price: High to Low"}),e.jsx("option",{value:"deductible_asc",children:"Lowest Deductible"}),e.jsx("option",{value:"rating",children:"Carrier Rating"})]})]})]})]}),v==="compare"&&e.jsx("div",{className:"bg-white rounded-2xl border border-slate-200 overflow-x-auto mb-6",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-slate-100",children:[e.jsx("th",{className:"text-left p-4 font-semibold text-slate-700 sticky left-0 bg-white min-w-[140px]",children:"Carrier"}),n.map(s=>{const t=s.carrier_product?.carrier;return e.jsx("th",{className:`p-4 text-center min-w-[150px] ${s.is_recommended?"bg-shield-50/50":""}`,children:e.jsxs("div",{className:"flex flex-col items-center gap-1",children:[e.jsx("span",{className:"font-semibold text-slate-900",children:t?.name||"Carrier"}),s.is_recommended&&e.jsx(V,{variant:"shield",className:"text-xs",children:"Best Value"})]})},s.id)})]})}),e.jsxs("tbody",{children:[e.jsxs("tr",{className:"border-b border-slate-50",children:[e.jsx("td",{className:"p-4 font-medium text-slate-700 sticky left-0 bg-white",children:"Monthly Premium"}),n.map(s=>e.jsxs("td",{className:`p-4 text-center font-bold text-lg ${s.is_recommended?"bg-shield-50/50 text-shield-700":"text-slate-900"}`,children:["$",parseFloat(s.monthly_premium).toFixed(0)]},s.id))]}),e.jsxs("tr",{className:"border-b border-slate-50",children:[e.jsx("td",{className:"p-4 font-medium text-slate-700 sticky left-0 bg-white",children:"Annual Premium"}),n.map(s=>e.jsxs("td",{className:`p-4 text-center text-slate-600 ${s.is_recommended?"bg-shield-50/50":""}`,children:["$",parseFloat(s.annual_premium).toFixed(0)]},s.id))]}),e.jsxs("tr",{className:"border-b border-slate-50",children:[e.jsx("td",{className:"p-4 font-medium text-slate-700 sticky left-0 bg-white",children:"Deductible"}),n.map(s=>e.jsxs("td",{className:`p-4 text-center text-slate-600 ${s.is_recommended?"bg-shield-50/50":""}`,children:["$",parseFloat(s.deductible).toFixed(0)]},s.id))]}),e.jsxs("tr",{className:"border-b border-slate-50",children:[e.jsx("td",{className:"p-4 font-medium text-slate-700 sticky left-0 bg-white",children:"Coverage Limit"}),n.map(s=>e.jsx("td",{className:`p-4 text-center text-slate-600 ${s.is_recommended?"bg-shield-50/50":""}`,children:s.coverage_limit},s.id))]}),e.jsxs("tr",{className:"border-b border-slate-50",children:[e.jsx("td",{className:"p-4 font-medium text-slate-700 sticky left-0 bg-white",children:"AM Best Rating"}),n.map(s=>e.jsx("td",{className:`p-4 text-center ${s.is_recommended?"bg-shield-50/50":""}`,children:e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx(W,{className:"w-3.5 h-3.5 text-amber-500"}),e.jsx("span",{className:"font-medium text-slate-700",children:s.carrier_product?.carrier?.am_best_rating||"—"})]})},s.id))]}),e.jsxs("tr",{className:"border-b border-slate-50",children:[e.jsx("td",{className:"p-4 font-medium text-slate-700 sticky left-0 bg-white align-top",children:"Features"}),n.map(s=>e.jsx("td",{className:`p-4 ${s.is_recommended?"bg-shield-50/50":""}`,children:e.jsx("div",{className:"space-y-1",children:(s.features||[]).map((t,m)=>e.jsxs("div",{className:"flex items-center gap-1.5 text-xs text-slate-600",children:[e.jsx(Y,{className:"w-3 h-3 text-savings-500 flex-shrink-0"}),t]},m))})},s.id))]}),e.jsxs("tr",{children:[e.jsx("td",{className:"p-4 sticky left-0 bg-white"}),n.map(s=>e.jsx("td",{className:`p-4 text-center ${s.is_recommended?"bg-shield-50/50":""}`,children:e.jsx(r,{variant:x===s.id?"shield":"outline",size:"sm",className:"w-full",onClick:t=>R(s,t),children:"Select"})},s.id))]})]})]})}),v==="cards"&&e.jsx("div",{className:"space-y-4",children:n.map(s=>{const t=s.carrier_product?.carrier,m=t?.name||"Insurance Carrier",S=m.split(" ").map(l=>l[0]).join("").slice(0,2).toUpperCase(),T=t?.logo,z=t?.am_best_rating,k=parseFloat(s.monthly_premium),U=parseFloat(s.annual_premium),ce=parseFloat(s.deductible);return e.jsx(F,{className:`transition-all duration-200 cursor-pointer ${x===s.id?"ring-2 ring-shield-500":""} ${s.is_recommended?"border-shield-200 bg-shield-50/30":""}`,onClick:()=>b(s.id),children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center gap-6",children:[e.jsxs("div",{className:"flex items-center gap-4 lg:w-56",children:[T?e.jsx("img",{src:T,alt:m,className:"w-14 h-14 rounded-xl object-contain bg-white border border-slate-100 p-1"}):e.jsx("div",{className:"w-14 h-14 rounded-xl bg-shield-100 text-shield-700 flex items-center justify-center text-lg font-bold",children:S}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-slate-900",children:m}),z&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(W,{className:"w-3.5 h-3.5 text-amber-500"}),e.jsxs("span",{className:"text-sm text-slate-600",children:["AM Best: ",z]})]})]}),s.is_recommended&&e.jsx(V,{variant:"shield",className:"ml-auto lg:ml-0",children:"Best Value"})]}),e.jsxs("div",{className:"flex-1 grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 uppercase tracking-wider",children:"Monthly"}),e.jsxs("p",{className:"text-xl font-bold text-slate-900",children:["$",k.toFixed(0)]}),e.jsxs("p",{className:"text-xs text-slate-400",children:["$",U.toFixed(0),"/yr"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 uppercase tracking-wider",children:"Deductible"}),e.jsxs("p",{className:"text-xl font-bold text-slate-900",children:["$",ce.toFixed(0)]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 uppercase tracking-wider",children:"Coverage"}),e.jsx("p",{className:"text-xl font-bold text-slate-900",children:s.coverage_limit})]})]}),e.jsx("div",{className:"lg:w-56",children:(s.features||[]).slice(0,3).map((l,oe)=>e.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-600",children:[e.jsx(Y,{className:"w-3.5 h-3.5 text-savings-500 flex-shrink-0"}),l]},oe))}),e.jsx("div",{className:"lg:w-40",children:e.jsx(r,{variant:x===s.id?"shield":"outline",className:"w-full",rightIcon:e.jsx($,{className:"w-4 h-4"}),onClick:l=>R(s,l),children:"Select"})})]}),e.jsxs("button",{onClick:l=>{l.stopPropagation(),se(C===s.id?null:s.id)},className:"mt-4 flex items-center gap-1 text-xs text-shield-600 hover:text-shield-700 font-medium",children:[e.jsx(be,{className:`w-3.5 h-3.5 transition-transform ${C===s.id?"rotate-180":""}`}),"Premium Breakdown"]}),C===s.id&&(()=>{const l=_e(k,U);return e.jsxs("div",{className:"mt-3 pt-3 border-t border-slate-100",children:[e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-500 text-xs",children:"Base Rate"}),e.jsxs("p",{className:"font-semibold text-slate-900",children:["$",l.baseRate.toFixed(0),"/mo"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-500 text-xs",children:"Policy Fee"}),e.jsxs("p",{className:"font-semibold text-slate-900",children:["+$",l.policyFee,"/mo"]})]}),l.multiPolicyDiscount<0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-500 text-xs",children:"Multi-Policy Discount"}),e.jsxs("p",{className:"font-semibold text-savings-600",children:[l.multiPolicyDiscount,"/mo"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-500 text-xs",children:"Monthly Total"}),e.jsxs("p",{className:"font-bold text-slate-900",children:["$",l.monthlyTotal.toFixed(0),"/mo"]})]})]}),l.annualSavings>0&&e.jsxs("p",{className:"mt-2 text-xs text-savings-600 font-medium",children:["Pay annually and save $",l.annualSavings,"/yr (",Math.round(l.annualSavings/(k*12)*100),"% off)"]})]})})()]})},s.id)})}),!g&&e.jsx("div",{id:"save-section",children:e.jsx(F,{className:"mt-10 border-shield-200 bg-gradient-to-r from-shield-50/50 to-blue-50/50",children:e.jsx("div",{className:"p-8",children:y?e.jsxs("div",{className:"text-center",children:[e.jsx(G,{className:"w-12 h-12 text-savings-500 mx-auto mb-3"}),e.jsx("h3",{className:"text-xl font-bold text-slate-900 mb-1",children:"You're all set!"}),e.jsx("p",{className:"text-slate-500 mb-5",children:"Your account is ready. Track your quotes, apply for policies, and connect with agents."}),e.jsxs("div",{className:"flex items-center justify-center gap-3",children:[e.jsx(d,{to:"/dashboard",children:e.jsx(r,{variant:"shield",rightIcon:e.jsx($,{className:"w-4 h-4"}),children:"Go to Dashboard"})}),e.jsx(d,{to:"/marketplace",children:e.jsx(r,{variant:"outline",children:"Find an Agent"})})]})]}):M&&!A?e.jsxs("div",{className:"text-center",children:[e.jsx(G,{className:"w-12 h-12 text-savings-500 mx-auto mb-3"}),e.jsx("h3",{className:"text-xl font-bold text-slate-900 mb-1",children:"Quotes Saved!"}),e.jsx("p",{className:"text-slate-500 mb-5",children:"Create a free account to track your quotes, apply for policies, and get matched with agents."}),e.jsxs("div",{className:"flex items-center justify-center gap-3",children:[e.jsx(r,{variant:"shield",onClick:()=>K(!0),leftIcon:e.jsx(we,{className:"w-4 h-4"}),children:"Create Free Account"}),e.jsx(d,{to:"/marketplace",children:e.jsx(r,{variant:"outline",children:"Maybe Later"})})]})]}):M&&A?e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-1 text-center",children:"Create your free account"}),e.jsx("p",{className:"text-sm text-slate-500 mb-4 text-center",children:"Just pick a password — we already have your details from saving your quotes."}),e.jsxs("div",{className:"max-w-sm mx-auto space-y-4",children:[e.jsxs("div",{className:"p-3 rounded-lg bg-slate-50 border border-slate-200 text-sm text-slate-600",children:[e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Name:"})," ",a.first_name," ",a.last_name]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Email:"})," ",a.email]})]}),Q&&e.jsx("div",{className:"p-3 rounded-lg bg-red-50 text-red-700 text-sm",children:Q}),e.jsx(h,{label:"Password",type:"password",placeholder:"Create a password (8+ characters)",value:o.password,onChange:s=>L(t=>({...t,password:s.target.value})),leftIcon:e.jsx(J,{className:"w-4 h-4"})}),e.jsx(h,{label:"Confirm Password",type:"password",placeholder:"Confirm your password",value:o.password_confirmation,onChange:s=>L(t=>({...t,password_confirmation:s.target.value})),leftIcon:e.jsx(J,{className:"w-4 h-4"})}),e.jsx(r,{variant:"shield",className:"w-full",onClick:ne,isLoading:X,disabled:!o.password||!o.password_confirmation,children:"Create Account"}),e.jsx("p",{className:"text-xs text-slate-400 text-center",children:"Free forever for consumers. No credit card required."})]})]}):H?e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-4 text-center",children:"Enter your details to save these quotes"}),e.jsxs("div",{className:"max-w-lg mx-auto space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx(h,{label:"First Name",placeholder:"John",value:a.first_name,onChange:s=>f(t=>({...t,first_name:s.target.value}))}),e.jsx(h,{label:"Last Name",placeholder:"Smith",value:a.last_name,onChange:s=>f(t=>({...t,last_name:s.target.value}))})]}),e.jsx(h,{label:"Email",type:"email",placeholder:"you@example.com",value:a.email,onChange:s=>f(t=>({...t,email:s.target.value}))}),e.jsx(h,{label:"Phone (optional)",type:"tel",placeholder:"(555) 123-4567",value:a.phone,onChange:s=>f(t=>({...t,phone:s.target.value}))}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(r,{variant:"outline",className:"flex-1",onClick:()=>w(!1),children:"Cancel"}),e.jsx(r,{variant:"shield",className:"flex-1",onClick:ie,isLoading:O,disabled:!a.first_name||!a.email,children:"Save My Quotes"})]}),e.jsx("p",{className:"text-xs text-slate-400 text-center",children:"We won't spam you. Your info is only used to save and email your quotes."})]})]}):e.jsxs("div",{className:"text-center",children:[e.jsx(Z,{className:"w-10 h-10 text-shield-500 mx-auto mb-3"}),e.jsx("h3",{className:"text-xl font-bold text-slate-900 mb-1",children:"Want to save these quotes?"}),e.jsx("p",{className:"text-slate-500 mb-5",children:"Get your quotes emailed to you — valid for 30 days. No account required."}),e.jsx(r,{variant:"shield",onClick:()=>w(!0),leftIcon:e.jsx(Z,{className:"w-4 h-4"}),children:"Email My Quotes"})]})})})}),e.jsxs("div",{className:"mt-10 text-center",children:[e.jsx("p",{className:"text-slate-500 mb-4",children:"Want help choosing the right policy? Connect with a licensed agent."}),e.jsxs("div",{className:"flex items-center justify-center gap-4",children:[e.jsx(d,{to:"/marketplace",children:e.jsx(r,{variant:"shield",rightIcon:e.jsx($,{className:"w-4 h-4"}),children:"Find an Agent"})}),e.jsx(r,{variant:"outline",leftIcon:e.jsx(ye,{className:"w-4 h-4"}),children:"Call 1-800-INSURE"})]})]})]})]})}export{Me as default};
