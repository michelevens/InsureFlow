import{j as e}from"./vendor-query-D5ml2kdZ.js";import{r as i}from"./vendor-react-C8VcOkCS.js";import{ax as C,y as S,a8 as J,u as A,a5 as L,d as M,ad as p}from"./vendor-ui-tJ0aMxU9.js";import{b as r,B as h,C as x,I as $}from"./index-BZEM9EbM.js";import{B as v}from"./Badge-8fS5vckW.js";import{M as T}from"./Modal-Cn8_xSIn.js";function R(t){if(!t)return"";const l=Object.entries(t).filter(([,c])=>c!==void 0);return l.length?"?"+new URLSearchParams(l.map(([c,d])=>[c,String(d)])).toString():""}const m={listPostings:t=>r.get(`/recruitment/postings${R(t)}`),getPosting:t=>r.get(`/recruitment/postings/${t}`),createPosting:t=>r.post("/recruitment/postings",t),updatePosting:(t,l)=>r.put(`/recruitment/postings/${t}`,l),deletePosting:t=>r.delete(`/recruitment/postings/${t}`),listApplications:t=>r.get(`/recruitment/postings/${t}/applications`),getApplication:t=>r.get(`/recruitment/applications/${t}`),updateApplication:(t,l)=>r.put(`/recruitment/applications/${t}`,l),browseJobs:t=>r.get(`/recruitment/jobs${R(t)}`),applyToJob:(t,l)=>r.upload(`/recruitment/jobs/${t}/apply`,l)},_={draft:"default",published:"success",closed:"danger",submitted:"info",reviewing:"warning",interview:"info",offered:"success",hired:"success",rejected:"danger"};function V(){const[t,l]=i.useState("postings"),[c,d]=i.useState([]),[o,b]=i.useState(null),[u,f]=i.useState([]),[g,y]=i.useState([]),[N,j]=i.useState(!0),[w,n]=i.useState(!1);i.useEffect(()=>{(async()=>{j(!0);try{if(t==="postings"){const a=await m.listPostings();d(a)}else if(t==="browse"){const a=await m.browseJobs();y(a)}}catch{p.error("Failed to load recruitment data")}finally{j(!1)}})()},[t]);const P=async s=>{b(s);try{const a=await m.listApplications(s.id);f(a)}catch{f([])}},B=async s=>{try{await m.deletePosting(s),p.success("Job posting deleted"),d(a=>a.filter(k=>k.id!==s)),o?.id===s&&b(null)}catch{p.error("Failed to delete job posting")}},z=async(s,a)=>{try{await m.updateApplication(s,{status:a}),p.success(`Application status updated to ${a}`),o&&P(o)}catch{p.error("Failed to update application status")}},F=[{key:"postings",label:"My Job Postings"},{key:"applications",label:"Applications"},{key:"browse",label:"Job Board"}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:"Recruitment"}),e.jsx("p",{className:"text-slate-500 mt-1",children:"Recruit, review, and hire insurance agents"})]}),e.jsxs(h,{variant:"shield",onClick:()=>n(!0),children:[e.jsx(C,{className:"w-4 h-4 mr-1"})," Post Job"]})]}),e.jsx("div",{className:"flex gap-1 bg-slate-100 rounded-xl p-1",children:F.map(s=>e.jsx("button",{onClick:()=>l(s.key),className:`px-4 py-2.5 rounded-lg text-sm font-medium transition-all flex-1 text-center ${t===s.key?"bg-white text-shield-700 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:s.label},s.key))}),N?e.jsx(x,{className:"p-8 text-center",children:e.jsx("div",{className:"w-8 h-8 border-4 border-shield-200 border-t-shield-600 rounded-full animate-spin mx-auto"})}):t==="postings"?e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-2 space-y-3",children:c.length===0?e.jsxs(x,{className:"p-12 text-center",children:[e.jsx(S,{className:"w-12 h-12 text-slate-300 mx-auto mb-3"}),e.jsx("p",{className:"text-slate-500 mb-4",children:"No job postings yet"}),e.jsxs(h,{variant:"shield",onClick:()=>n(!0),children:[e.jsx(C,{className:"w-4 h-4 mr-1"})," Create First Posting"]})]}):c.map(s=>e.jsxs(x,{className:`p-4 cursor-pointer transition-all ${o?.id===s.id?"ring-2 ring-shield-500":"hover:shadow-md"}`,onClick:()=>P(s),children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-slate-900",children:s.title}),e.jsxs("div",{className:"flex items-center gap-3 mt-1 text-xs text-slate-500",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(J,{className:"w-3 h-3"})," ",s.location]}),s.is_remote&&e.jsx(v,{variant:"info",children:"Remote"}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(A,{className:"w-3 h-3"})," ",s.applications_count," applicants"]})]})]}),e.jsx(v,{variant:_[s.status],children:s.status})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-3",children:[e.jsxs(h,{variant:"ghost",size:"sm",onClick:a=>{a.stopPropagation(),P(s)},children:[e.jsx(L,{className:"w-3.5 h-3.5 mr-1"})," View Apps"]}),e.jsx(h,{variant:"ghost",size:"sm",onClick:a=>{a.stopPropagation(),B(s.id)},children:e.jsx(M,{className:"w-3.5 h-3.5 text-red-400"})})]})]},s.id))}),e.jsx("div",{children:o?e.jsxs(x,{className:"p-5 sticky top-4",children:[e.jsx("h3",{className:"font-bold text-slate-900 mb-1",children:o.title}),e.jsxs("p",{className:"text-xs text-slate-500 mb-4",children:[u.length," applications"]}),e.jsxs("div",{className:"space-y-3",children:[u.map(s=>e.jsxs("div",{className:"bg-slate-50 rounded-xl p-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"font-medium text-slate-900 text-sm",children:s.applicant_name}),e.jsx(v,{variant:_[s.status],children:s.status})]}),e.jsx("p",{className:"text-xs text-slate-500",children:s.applicant_email}),s.experience&&e.jsxs("p",{className:"text-xs text-slate-400 mt-1",children:[s.experience.years,"y exp â€¢ ",s.experience.specialties?.join(", ")]}),e.jsx("div",{className:"flex gap-1 mt-2",children:["reviewing","interview","offered","hired","rejected"].filter(a=>a!==s.status).slice(0,3).map(a=>e.jsx("button",{onClick:()=>z(s.id,a),className:"text-xs px-2 py-1 rounded bg-white border border-slate-200 text-slate-600 hover:border-shield-300 capitalize",children:a},a))})]},s.id)),u.length===0&&e.jsx("p",{className:"text-sm text-slate-400 text-center py-4",children:"No applications yet"})]})]}):e.jsxs(x,{className:"p-8 text-center text-slate-400",children:[e.jsx(A,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),e.jsx("p",{className:"text-sm",children:"Select a posting to view applications"})]})})]}):t==="browse"?e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[g.map(s=>e.jsxs(x,{className:"p-5",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-slate-900",children:s.title}),e.jsx("p",{className:"text-sm text-slate-500",children:s.agency_name})]}),s.is_remote&&e.jsx(v,{variant:"info",children:"Remote"})]}),e.jsxs("div",{className:"flex items-center gap-3 text-xs text-slate-500 mb-3",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(J,{className:"w-3 h-3"})," ",s.location]}),s.compensation?.type&&e.jsx("span",{children:s.compensation.type})]}),s.requirements&&e.jsx("div",{className:"flex flex-wrap gap-1 mb-3",children:s.requirements.slice(0,3).map((a,k)=>e.jsx("span",{className:"text-xs bg-slate-100 text-slate-600 px-2 py-0.5 rounded-full",children:a},k))}),e.jsx(h,{variant:"shield",size:"sm",className:"w-full",children:"Apply Now"})]},s.id)),g.length===0&&e.jsxs(x,{className:"p-12 text-center col-span-2",children:[e.jsx(S,{className:"w-12 h-12 text-slate-300 mx-auto mb-3"}),e.jsx("p",{className:"text-slate-500",children:"No open positions available"})]})]}):null,w&&e.jsx(D,{onClose:()=>n(!1),onCreated:()=>{n(!1),m.listPostings().then(d)}})]})}function D({onClose:t,onCreated:l}){const[c,d]=i.useState(""),[o,b]=i.useState(""),[u,f]=i.useState(""),[g,y]=i.useState(!1),[N,j]=i.useState(!1),w=async()=>{if(c){j(!0);try{await m.createPosting({title:c,description:o,location:u,is_remote:g,status:"published"}),p.success("Job posting published successfully"),l()}catch{p.error("Failed to create job posting")}finally{j(!1)}}};return e.jsx(T,{isOpen:!0,onClose:t,title:"Post a Job",size:"md",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx($,{label:"Job Title",placeholder:"Licensed Insurance Agent",value:c,onChange:n=>d(n.target.value)}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 block mb-1",children:"Description"}),e.jsx("textarea",{value:o,onChange:n=>b(n.target.value),className:"w-full h-24 text-sm border border-slate-200 rounded-lg p-3 focus:ring-2 focus:ring-shield-500 focus:border-shield-500",placeholder:"Describe the role and what you're looking for..."})]}),e.jsx($,{label:"Location",placeholder:"New York, NY",value:u,onChange:n=>f(n.target.value)}),e.jsxs("label",{className:"flex items-center gap-2 text-sm text-slate-700",children:[e.jsx("input",{type:"checkbox",checked:g,onChange:n=>y(n.target.checked),className:"rounded border-slate-300"}),"Remote friendly"]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[e.jsx(h,{variant:"ghost",onClick:t,children:"Cancel"}),e.jsx(h,{variant:"shield",onClick:w,disabled:N||!c,children:N?"Publishing...":"Publish Job"})]})]})})}export{V as default};
